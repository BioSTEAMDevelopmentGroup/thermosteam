

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>thermosteam.functors.eos &mdash; Thermosteam  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Thermosteam
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Overview.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Getting started.html">3. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Thermodynamic equilibrium.html">4. Thermodynamic equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Stoichiometric reactions.html">5. Stoichiometric reactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Extending chemicals.html">6. Extending chemicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Building new chemicals.html">7. Creating new chemicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/Extending equilibrium coefficients.html">8. Extending equilibrium coefficients</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Chemical.html">Chemical</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Chemicals.html">Chemicals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Thermo.html">Thermo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Stream.html">Stream</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../MultiStream.html">MultiStream</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ThermalCondition.html">ThermalCondition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functor.html">functor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../equilibrium/equilibrium_module.html">equilibrium</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reaction/reaction_module.html">reaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../indexer/indexer_module.html">indexer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exceptions.html">exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functional.html">functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functors/functors_module.html">functors</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Thermosteam</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>thermosteam.functors.eos</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for thermosteam.functors.eos</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&#39;&#39;&#39;Chemical Engineering Design Library (ChEDL). Utilities for process modeling.</span>
<span class="sd">Copyright (C) 2016, Caleb Bell &lt;Caleb.Andrew.Bell@gmail.com&gt;</span>

<span class="sd">Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="sd">of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="sd">in the Software without restriction, including without limitation the rights</span>
<span class="sd">to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="sd">copies of the Software, and to permit persons to whom the Software is</span>
<span class="sd">furnished to do so, subject to the following conditions:</span>

<span class="sd">The above copyright notice and this permission notice shall be included in all</span>
<span class="sd">copies or substantial portions of the Software.</span>

<span class="sd">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="sd">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="sd">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="sd">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="sd">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="sd">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="sd">SOFTWARE.&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;GCEOS&#39;</span><span class="p">,</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span> <span class="s1">&#39;SRK&#39;</span><span class="p">,</span> <span class="s1">&#39;PR78&#39;</span><span class="p">,</span> <span class="s1">&#39;PRSV&#39;</span><span class="p">,</span> <span class="s1">&#39;PRSV2&#39;</span><span class="p">,</span> <span class="s1">&#39;VDW&#39;</span><span class="p">,</span> <span class="s1">&#39;RK&#39;</span><span class="p">,</span>  
<span class="s1">&#39;APISRK&#39;</span><span class="p">,</span> <span class="s1">&#39;TWUPR&#39;</span><span class="p">,</span> <span class="s1">&#39;TWUSRK&#39;</span><span class="p">,</span> <span class="s1">&#39;ALPHA_FUNCTIONS&#39;</span><span class="p">,</span> <span class="s1">&#39;eos_list&#39;</span><span class="p">,</span> <span class="s1">&#39;GCEOS_DUMMY&#39;</span><span class="p">]</span>

<span class="kn">from</span> <span class="nn">cmath</span> <span class="kn">import</span> <span class="n">atanh</span> <span class="k">as</span> <span class="n">catanh</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
<span class="kn">from</span> <span class="nn">..functional</span> <span class="kn">import</span> <span class="n">Cp_minus_Cv</span><span class="p">,</span> <span class="n">isobaric_expansion</span><span class="p">,</span> \
                        <span class="n">isothermal_compressibility</span><span class="p">,</span> \
                        <span class="n">phase_identification_parameter</span><span class="p">,</span> <span class="n">horner</span>
<span class="kn">from</span> <span class="nn">.._constants</span> <span class="kn">import</span> <span class="n">R</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">copysign</span>


<div class="viewcode-block" id="GCEOS"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS">[docs]</a><span class="k">class</span> <span class="nc">GCEOS</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving a generic Pressure-explicit three-parameter cubic </span>
<span class="sd">    equation of state. Does not implement any parameters itself; must be </span>
<span class="sd">    subclassed by an equation of state class which uses it. Works for mixtures</span>
<span class="sd">    or pure species for all properties except fugacity. All properties are </span>
<span class="sd">    derived with the CAS SymPy, not relying on any derivations previously </span>
<span class="sd">    published.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P=\frac{RT}{V-b}-\frac{a\alpha(T)}{V^2 + \delta V + \epsilon}</span>

<span class="sd">    Main methods (in order they are called) are `solve`, `set_from_PT`,</span>
<span class="sd">    `volume_solutions`, `set_properties_from_solution`,  and</span>
<span class="sd">    `derivatives_and_departures`. </span>

<span class="sd">    `solve` calls `check_sufficient_input`, which checks if two of `T`, `P`, </span>
<span class="sd">    and `V` were set. It then solves for the </span>
<span class="sd">    remaining variable. If `T` is missing, method `solve_T` is used; it is</span>
<span class="sd">    parameter specific, and so must be implemented in each specific EOS. </span>
<span class="sd">    If `P` is missing, it is directly calculated. If `V` is missing, it</span>
<span class="sd">    is calculated with the method `volume_solutions`. At this point, either</span>
<span class="sd">    three possible volumes or one user specified volume are known. The</span>
<span class="sd">    value of `a_alpha`, and its first and second temperature derivative are</span>
<span class="sd">    calculated with the EOS-specific method `a_alpha_and_derivatives`. </span>

<span class="sd">    If `V` is not provided, `volume_solutions` calculates the three </span>
<span class="sd">    possible molar volumes which are solutions to the EOS; in the single-phase </span>
<span class="sd">    region, only one solution is real and correct. In the two-phase region, all </span>
<span class="sd">    volumes are real, but only the largest and smallest solution are physically </span>
<span class="sd">    meaningful, with the largest being that of the gas and the smallest that of</span>
<span class="sd">    the liquid.</span>

<span class="sd">    `set_from_PT` is called to sort out the possible molar volumes. For the </span>
<span class="sd">    case of a user-specified `V`, the possibility of there existing another </span>
<span class="sd">    solution is ignored for speed. If there is only one real volume, the </span>
<span class="sd">    method `set_properties_from_solution` is called with it. If there are</span>
<span class="sd">    two real volumes, `set_properties_from_solution` is called once with each </span>
<span class="sd">    volume. The phase is returned by `set_properties_from_solution`, and the</span>
<span class="sd">    volumes is set to either `V_l` or `V_g` as appropriate. </span>
<span class="sd">    </span>
<span class="sd">    `set_properties_from_solution` is a beast which calculates all relevant</span>
<span class="sd">    partial derivatives and properties of the EOS. 15 derivatives and excess</span>
<span class="sd">    enthalpy and entropy are calculated first. If the method was called with </span>
<span class="sd">    the `quick` flag, the method `derivatives_and_departures` uses a mess </span>
<span class="sd">    derived with SymPy&#39;s `cse` function to perform the calculation as quickly</span>
<span class="sd">    as possible. Otherwise, the independent formulas for each property are used.</span>

<span class="sd">    `set_properties_from_solution` next calculates `beta` (isobaric expansion</span>
<span class="sd">    coefficient), `kappa` (isothermal compressibility), `Cp_minus_Cv`, `Cv_dep`,</span>
<span class="sd">    `Cp_dep`, `V_dep` molar volume departure, `U_dep` internal energy departure,</span>
<span class="sd">    `G_dep` Gibbs energy departure, `A_dep` Helmholtz energy departure,</span>
<span class="sd">    `fugacity`, and `phi` (fugacity coefficient). It then calculates</span>
<span class="sd">    `PIP` or phase identification parameter, and determines the fluid phase</span>
<span class="sd">    with it. Finally, it sets all these properties as attibutes or either </span>
<span class="sd">    the liquid or gas phase with the convention of adding on `_l` or `_g` to</span>
<span class="sd">    the variable names.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<div class="viewcode-block" id="GCEOS.check_sufficient_inputs"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.check_sufficient_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_sufficient_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Method to an exception if none of the pairs (T, P), (T, V), or </span>
<span class="sd">        (P, V) are given. &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Either T and P, or T and V, or P and V are required&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GCEOS.solve"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.solve">[docs]</a>    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;First EOS-generic method; should be called by all specific EOSs.</span>
<span class="sd">        For solving for `T`, the EOS must provide the method `solve_T`.</span>
<span class="sd">        For all cases, the EOS must provide `a_alpha_and_derivatives`.</span>
<span class="sd">        Calls `set_from_PT` once done.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_sufficient_inputs</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">da_alpha_dT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">da_alpha_dT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
            <span class="n">Vs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">da_alpha_dT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">Vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_solutions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_from_PT</span><span class="p">(</span><span class="n">Vs</span><span class="p">)</span></div>

<div class="viewcode-block" id="GCEOS.set_from_PT"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.set_from_PT">[docs]</a>    <span class="k">def</span> <span class="nf">set_from_PT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Vs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Counts the number of real volumes in `Vs`, and determines what to do.</span>
<span class="sd">        If there is only one real volume, the method </span>
<span class="sd">        `set_properties_from_solution` is called with it. If there are</span>
<span class="sd">        two real volumes, `set_properties_from_solution` is called once with  </span>
<span class="sd">        each volume. The phase is returned by `set_properties_from_solution`, </span>
<span class="sd">        and the volumes is set to either `V_l` or `V_g` as appropriate. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Vs : list[float]</span>
<span class="sd">            Three possible molar volumes, [m^3/mol]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># All roots will have some imaginary component; ignore them if &gt; 1E-9</span>
        <span class="n">good_roots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">bad_roots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Vs</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">real</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1E-9</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">bad_roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">good_roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bad_roots</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> 
            <span class="n">V</span> <span class="o">=</span> <span class="n">good_roots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_properties_from_solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">da_alpha_dT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2a_alpha_dT2</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">V_l</span> <span class="o">=</span> <span class="n">V</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">V_g</span> <span class="o">=</span> <span class="n">V</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Even in the case of three real roots, it is still the min/max that make sense</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">V_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V_g</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">good_roots</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">good_roots</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">set_properties_from_solution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">da_alpha_dT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2a_alpha_dT2</span><span class="p">)</span> <span class="k">for</span> <span class="n">V</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">V_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V_g</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="s1">&#39;l/g&#39;</span></div>

<div class="viewcode-block" id="GCEOS.set_properties_from_solution"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.set_properties_from_solution">[docs]</a>    <span class="k">def</span> <span class="nf">set_properties_from_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">,</span> 
                                     <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Sets all interesting properties which can be calculated from an</span>
<span class="sd">        EOS alone. Determines which phase the fluid is on its own; for details,</span>
<span class="sd">        see `phase_identification_parameter`.</span>
<span class="sd">        </span>
<span class="sd">        The list of properties set is as follows, with all properties suffixed</span>
<span class="sd">        with &#39;_l&#39; or &#39;_g&#39;.</span>
<span class="sd">        </span>
<span class="sd">        dP_dT, dP_dV, dV_dT, dV_dP, dT_dV, dT_dP, d2P_dT2, d2P_dV2, d2V_dT2, </span>
<span class="sd">        d2V_dP2, d2T_dV2, d2T_dP2, d2V_dPdT, d2P_dTdV, d2T_dPdV, H_dep, S_dep, </span>
<span class="sd">        beta, kappa, Cp_minus_Cv, V_dep, U_dep, G_dep, A_dep, fugacity, phi, </span>
<span class="sd">        and PIP.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        b : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [m^3/mol]</span>
<span class="sd">        delta : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [m^3/mol]</span>
<span class="sd">        epsilon : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [m^6/mol^2]</span>
<span class="sd">        a_alpha : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [J^2/mol^2/Pa]</span>
<span class="sd">        da_alpha_dT : float</span>
<span class="sd">            Temperature derivative of coefficient calculated by EOS-specific </span>
<span class="sd">            method, [J^2/mol^2/Pa/K]</span>
<span class="sd">        d2a_alpha_dT2 : float</span>
<span class="sd">            Second temperature derivative of coefficient calculated by  </span>
<span class="sd">            EOS-specific method, [J^2/mol^2/Pa/K**2]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        phase : str</span>
<span class="sd">            Either &#39;l&#39; or &#39;g&#39;</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The individual formulas for the derivatives and excess properties are </span>
<span class="sd">        as follows. For definitions of `beta`, see `isobaric_expansion`;</span>
<span class="sd">        for `kappa`, see isothermal_compressibility; for `Cp_minus_Cv`, see</span>
<span class="sd">        `Cp_minus_Cv`; for `phase_identification_parameter`, see </span>
<span class="sd">        `phase_identification_parameter`.</span>
<span class="sd">        </span>
<span class="sd">        First derivatives; in part using the Triple Product Rule [2]_, [3]_:</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V = \frac{R}{V - b}</span>
<span class="sd">            - \frac{a \frac{d \alpha{\left (T \right )}}{d T}}{V^{2} + V \delta</span>
<span class="sd">            + \epsilon}</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T = - \frac{R T}{\left(</span>
<span class="sd">            V - b\right)^{2}} - \frac{a \left(- 2 V - \delta\right) \alpha{</span>
<span class="sd">            \left (T \right )}}{\left(V^{2} + V \delta + \epsilon\right)^{2}}</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial V}{\partial T}\right)_P =-\frac{</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V}{</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T}</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial V}{\partial P}\right)_T =-\frac{</span>
<span class="sd">            \left(\frac{\partial V}{\partial T}\right)_P}{</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V}            </span>

<span class="sd">            \left(\frac{\partial T}{\partial V}\right)_P = \frac{1}</span>
<span class="sd">            {\left(\frac{\partial V}{\partial T}\right)_P}</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial T}{\partial P}\right)_V = \frac{1}</span>
<span class="sd">            {\left(\frac{\partial P}{\partial T}\right)_V}</span>
<span class="sd">            </span>
<span class="sd">        Second derivatives with respect to one variable; those of `T` and `V`</span>
<span class="sd">        use identities shown in [1]_ and verified numerically:</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \left(\frac{\partial^2  P}{\partial T^2}\right)_V =  - \frac{a </span>
<span class="sd">            \frac{d^{2} \alpha{\left (T \right )}}{d T^{2}}}{V^{2} + V \delta </span>
<span class="sd">            + \epsilon}</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial^2  P}{\partial V^2}\right)_T = 2 \left(\frac{</span>
<span class="sd">            R T}{\left(V - b\right)^{3}} - \frac{a \left(2 V + \delta\right)^{</span>
<span class="sd">            2} \alpha{\left (T \right )}}{\left(V^{2} + V \delta + \epsilon</span>
<span class="sd">            \right)^{3}} + \frac{a \alpha{\left (T \right )}}{\left(V^{2} + V </span>
<span class="sd">            \delta + \epsilon\right)^{2}}\right)</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial^2 T}{\partial P^2}\right)_V = -\left(\frac{</span>
<span class="sd">            \partial^2 P}{\partial T^2}\right)_V \left(\frac{\partial P}{</span>
<span class="sd">            \partial T}\right)^{-3}_V</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial^2 V}{\partial P^2}\right)_T = -\left(\frac{</span>
<span class="sd">            \partial^2 P}{\partial V^2}\right)_T \left(\frac{\partial P}{</span>
<span class="sd">            \partial V}\right)^{-3}_T</span>
<span class="sd">            </span>
<span class="sd">            \left(\frac{\partial^2 T}{\partial V^2}\right)_P = -\left[</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial V^2}\right)_T</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V</span>
<span class="sd">            - \left(\frac{\partial P}{\partial V}\right)_T</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial T \partial V}\right) \right]</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)^{-2}_V</span>
<span class="sd">            + \left[\left(\frac{\partial^2 P}{\partial T\partial V}\right)</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V </span>
<span class="sd">            - \left(\frac{\partial P}{\partial V}\right)_T</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial T^2}\right)_V\right]</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V^{-3}</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T</span>

<span class="sd">            \left(\frac{\partial^2 V}{\partial T^2}\right)_P = -\left[</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial T^2}\right)_V</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T</span>
<span class="sd">            - \left(\frac{\partial P}{\partial T}\right)_V</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial T \partial V}\right) \right]</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)^{-2}_T</span>
<span class="sd">            + \left[\left(\frac{\partial^2 P}{\partial T\partial V}\right)</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T </span>
<span class="sd">            - \left(\frac{\partial P}{\partial T}\right)_V</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial V^2}\right)_T\right]</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T^{-3}</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V</span>

<span class="sd">                        </span>
<span class="sd">        Second derivatives with respect to the other two variables; those of </span>
<span class="sd">        `T` and `V` use identities shown in [1]_ and verified numerically:</span>

<span class="sd">        .. math::</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial T \partial V}\right) = - \frac{</span>
<span class="sd">            R}{\left(V - b\right)^{2}} + \frac{a \left(2 V + \delta\right) </span>
<span class="sd">            \frac{d \alpha{\left (T \right )}}{d T}}{\left(V^{2} + V \delta </span>
<span class="sd">            + \epsilon\right)^{2}}</span>
<span class="sd">           </span>
<span class="sd">           \left(\frac{\partial^2 T}{\partial P\partial V}\right) = </span>
<span class="sd">            - \left[\left(\frac{\partial^2 P}{\partial T \partial V}\right)</span>
<span class="sd">            \left(\frac{\partial P}{\partial T}\right)_V</span>
<span class="sd">            - \left(\frac{\partial P}{\partial V}\right)_T</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial T^2}\right)_V</span>
<span class="sd">            \right]\left(\frac{\partial P}{\partial T}\right)_V^{-3}</span>

<span class="sd">            \left(\frac{\partial^2 V}{\partial T\partial P}\right) = </span>
<span class="sd">            - \left[\left(\frac{\partial^2 P}{\partial T \partial V}\right)</span>
<span class="sd">            \left(\frac{\partial P}{\partial V}\right)_T</span>
<span class="sd">            - \left(\frac{\partial P}{\partial T}\right)_V</span>
<span class="sd">            \left(\frac{\partial^2 P}{\partial V^2}\right)_T</span>
<span class="sd">            \right]\left(\frac{\partial P}{\partial V}\right)_T^{-3}</span>

<span class="sd">        Excess properties</span>
<span class="sd">            </span>
<span class="sd">        .. math::</span>
<span class="sd">            H_{dep} = \int_{\infty}^V \left[T\frac{\partial P}{\partial T}_V </span>
<span class="sd">            - P\right]dV + PV - RT= P V - R T + \frac{2}{\sqrt{</span>
<span class="sd">            \delta^{2} - 4 \epsilon}} \left(T a \frac{d \alpha{\left (T \right </span>
<span class="sd">            )}}{d T}  - a \alpha{\left (T \right )}\right) \operatorname{atanh}</span>
<span class="sd">            {\left (\frac{2 V + \delta}{\sqrt{\delta^{2} - 4 \epsilon}} </span>
<span class="sd">            \right)}</span>

<span class="sd">            S_{dep} = \int_{\infty}^V\left[\frac{\partial P}{\partial T} </span>
<span class="sd">            - \frac{R}{V}\right] dV + R\log\frac{PV}{RT} = - R \log{\left (V </span>
<span class="sd">            \right )} + R \log{\left (\frac{P V}{R T} \right )} + R \log{\left</span>
<span class="sd">            (V - b \right )} + \frac{2 a \frac{d\alpha{\left (T \right )}}{d T}</span>
<span class="sd">            }{\sqrt{\delta^{2} - 4 \epsilon}} \operatorname{atanh}{\left (\frac</span>
<span class="sd">            {2 V + \delta}{\sqrt{\delta^{2} - 4 \epsilon}} \right )}</span>
<span class="sd">        </span>
<span class="sd">            V_{dep} = V - \frac{RT}{P}</span>
<span class="sd">            </span>
<span class="sd">            U_{dep} = H_{dep} - P V_{dep}</span>
<span class="sd">            </span>
<span class="sd">            G_{dep} = H_{dep} - T S_{dep}</span>
<span class="sd">            </span>
<span class="sd">            A_{dep} = U_{dep} - T S_{dep}</span>
<span class="sd">            </span>
<span class="sd">            \text{fugacity} = P\exp\left(\frac{G_{dep}}{RT}\right)</span>
<span class="sd">            </span>
<span class="sd">            \phi = \frac{\text{fugacity}}{P}</span>
<span class="sd">            </span>
<span class="sd">            C_{v, dep} = T\int_\infty^V \left(\frac{\partial^2 P}{\partial </span>
<span class="sd">            T^2}\right) dV = - T a \left(\sqrt{\frac{1}{\delta^{2} - 4 </span>
<span class="sd">            \epsilon}} \log{\left (V - \frac{\delta^{2}}{2} \sqrt{\frac{1}{</span>
<span class="sd">            \delta^{2} - 4 \epsilon}} + \frac{\delta}{2} + 2 \epsilon \sqrt{</span>
<span class="sd">            \frac{1}{\delta^{2} - 4 \epsilon}} \right )} - \sqrt{\frac{1}{</span>
<span class="sd">            \delta^{2} - 4 \epsilon}} \log{\left (V + \frac{\delta^{2}}{2} </span>
<span class="sd">            \sqrt{\frac{1}{\delta^{2} - 4 \epsilon}} + \frac{\delta}{2} </span>
<span class="sd">            - 2 \epsilon \sqrt{\frac{1}{\delta^{2} - 4 \epsilon}} \right )}</span>
<span class="sd">            \right) \frac{d^{2} \alpha{\left (T \right )} }{d T^{2}}  </span>
<span class="sd">            </span>
<span class="sd">            C_{p, dep} = (C_p-C_v)_{\text{from EOS}} + C_{v, dep} - R</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Thorade, Matthis, and Ali Saadat. &quot;Partial Derivatives of </span>
<span class="sd">           Thermodynamic State Properties for Dynamic Simulation.&quot; </span>
<span class="sd">           Environmental Earth Sciences 70, no. 8 (April 10, 2013): 3497-3503.</span>
<span class="sd">           doi:10.1007/s12665-013-2394-z.</span>
<span class="sd">        .. [2] Poling, Bruce E. The Properties of Gases and Liquids. 5th </span>
<span class="sd">           edition. New York: McGraw-Hill Professional, 2000.</span>
<span class="sd">        .. [3] Walas, Stanley M. Phase Equilibria in Chemical Engineering. </span>
<span class="sd">           Butterworth-Heinemann, 1985.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="p">([</span><span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">dV_dT</span><span class="p">,</span> <span class="n">dV_dP</span><span class="p">,</span> <span class="n">dT_dV</span><span class="p">,</span> <span class="n">dT_dP</span><span class="p">],</span> 
            <span class="p">[</span><span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span><span class="p">,</span> <span class="n">d2V_dT2</span><span class="p">,</span> <span class="n">d2V_dP2</span><span class="p">,</span> <span class="n">d2T_dV2</span><span class="p">,</span> <span class="n">d2T_dP2</span><span class="p">],</span>
            <span class="p">[</span><span class="n">d2V_dPdT</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">d2T_dPdV</span><span class="p">],</span>
            <span class="p">[</span><span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">Cv_dep</span><span class="p">])</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivatives_and_departures</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="n">quick</span><span class="p">)</span>
                
        <span class="n">beta</span> <span class="o">=</span> <span class="n">dV_dT</span><span class="o">/</span><span class="n">V</span> <span class="c1"># isobaric_expansion(V, dV_dT)</span>
        <span class="n">kappa</span> <span class="o">=</span> <span class="o">-</span><span class="n">dV_dP</span><span class="o">/</span><span class="n">V</span> <span class="c1"># isothermal_compressibility(V, dV_dP)</span>
        <span class="n">Cp_m_Cv</span> <span class="o">=</span> <span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">dP_dT</span><span class="o">*</span><span class="n">dP_dT</span><span class="o">/</span><span class="n">dP_dV</span> <span class="c1"># Cp_minus_Cv(T, dP_dT, dP_dV)</span>
        
        <span class="n">Cp_dep</span> <span class="o">=</span> <span class="n">Cp_m_Cv</span> <span class="o">+</span> <span class="n">Cv_dep</span> <span class="o">-</span> <span class="n">R</span>
                
        <span class="n">V_dep</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">P</span><span class="p">)</span>        
        <span class="n">U_dep</span> <span class="o">=</span> <span class="n">H_dep</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">V_dep</span>
        <span class="n">G_dep</span> <span class="o">=</span> <span class="n">H_dep</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">S_dep</span>
        <span class="n">A_dep</span> <span class="o">=</span> <span class="n">U_dep</span> <span class="o">-</span> <span class="n">T</span><span class="o">*</span><span class="n">S_dep</span>
        <span class="n">fugacity</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">G_dep</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">))</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">fugacity</span><span class="o">/</span><span class="n">P</span>
  
        <span class="n">PIP</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">d2P_dTdV</span><span class="o">/</span><span class="n">dP_dT</span> <span class="o">-</span> <span class="n">d2P_dV2</span><span class="o">/</span><span class="n">dP_dV</span><span class="p">)</span> <span class="c1"># phase_identification_parameter(V, dP_dT, dP_dV, d2P_dV2, d2P_dTdV)</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="s1">&#39;l&#39;</span> <span class="k">if</span> <span class="n">PIP</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;g&#39;</span> <span class="c1"># phase_identification_parameter_phase(PIP)</span>
      
        <span class="k">if</span> <span class="n">phase</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Z_l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa_l</span> <span class="o">=</span> <span class="n">beta</span><span class="p">,</span> <span class="n">kappa</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PIP_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp_minus_Cv_l</span> <span class="o">=</span> <span class="n">PIP</span><span class="p">,</span> <span class="n">Cp_m_Cv</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">dP_dT_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dP_dV_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dV_dT_l</span> <span class="o">=</span> <span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">dV_dT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dV_dP_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT_dV_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT_dP_l</span> <span class="o">=</span> <span class="n">dV_dP</span><span class="p">,</span> <span class="n">dT_dV</span><span class="p">,</span> <span class="n">dT_dP</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">d2P_dT2_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2P_dV2_l</span> <span class="o">=</span> <span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d2V_dT2_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2V_dP2_l</span> <span class="o">=</span> <span class="n">d2V_dT2</span><span class="p">,</span> <span class="n">d2V_dP2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d2T_dV2_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2T_dP2_l</span> <span class="o">=</span> <span class="n">d2T_dV2</span><span class="p">,</span> <span class="n">d2T_dP2</span>
                        
            <span class="bp">self</span><span class="o">.</span><span class="n">d2V_dPdT_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2P_dTdV_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2T_dPdV_l</span> <span class="o">=</span> <span class="n">d2V_dPdT</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">d2T_dPdV</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">H_dep_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_dep_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V_dep_l</span> <span class="o">=</span> <span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">V_dep</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">U_dep_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">G_dep_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_dep_l</span> <span class="o">=</span> <span class="n">U_dep</span><span class="p">,</span> <span class="n">G_dep</span><span class="p">,</span> <span class="n">A_dep</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">fugacity_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi_l</span> <span class="o">=</span> <span class="n">fugacity</span><span class="p">,</span> <span class="n">phi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cp_dep_l</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cv_dep_l</span> <span class="o">=</span> <span class="n">Cp_dep</span><span class="p">,</span> <span class="n">Cv_dep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Z_g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">beta_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa_g</span> <span class="o">=</span> <span class="n">beta</span><span class="p">,</span> <span class="n">kappa</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PIP_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cp_minus_Cv_g</span> <span class="o">=</span> <span class="n">PIP</span><span class="p">,</span> <span class="n">Cp_m_Cv</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">dP_dT_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dP_dV_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dV_dT_g</span> <span class="o">=</span> <span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">dV_dT</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dV_dP_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT_dV_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dT_dP_g</span> <span class="o">=</span> <span class="n">dV_dP</span><span class="p">,</span> <span class="n">dT_dV</span><span class="p">,</span> <span class="n">dT_dP</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">d2P_dT2_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2P_dV2_g</span> <span class="o">=</span> <span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d2V_dT2_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2V_dP2_g</span> <span class="o">=</span> <span class="n">d2V_dT2</span><span class="p">,</span> <span class="n">d2V_dP2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d2T_dV2_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2T_dP2_g</span> <span class="o">=</span> <span class="n">d2T_dV2</span><span class="p">,</span> <span class="n">d2T_dP2</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">d2V_dPdT_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2P_dTdV_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d2T_dPdV_g</span> <span class="o">=</span> <span class="n">d2V_dPdT</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">d2T_dPdV</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">H_dep_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_dep_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V_dep_g</span> <span class="o">=</span> <span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">V_dep</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">U_dep_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">G_dep_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">A_dep_g</span> <span class="o">=</span> <span class="n">U_dep</span><span class="p">,</span> <span class="n">G_dep</span><span class="p">,</span> <span class="n">A_dep</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">fugacity_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi_g</span> <span class="o">=</span> <span class="n">fugacity</span><span class="p">,</span> <span class="n">phi</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cp_dep_g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cv_dep_g</span> <span class="o">=</span> <span class="n">Cp_dep</span><span class="p">,</span> <span class="n">Cv_dep</span>
        <span class="k">return</span> <span class="n">phase</span>            </div>

<div class="viewcode-block" id="GCEOS.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Dummy method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives. Should be implemented with the same function signature in </span>
<span class="sd">        each EOS variant; this only raises a NotImplemented Exception.</span>
<span class="sd">        Should return &#39;a_alpha&#39;, &#39;da_alpha_dT&#39;, and &#39;d2a_alpha_dT2&#39;.</span>

<span class="sd">        For use in `solve_T`, returns only `a_alpha` if `full` is False.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        full : bool, optional</span>
<span class="sd">            If False, calculates and returns only `a_alpha`</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        a_alpha : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [J^2/mol^2/Pa]</span>
<span class="sd">        da_alpha_dT : float</span>
<span class="sd">            Temperature derivative of coefficient calculated by EOS-specific </span>
<span class="sd">            method, [J^2/mol^2/Pa/K]</span>
<span class="sd">        d2a_alpha_dT2 : float</span>
<span class="sd">            Second temperature derivative of coefficient calculated by  </span>
<span class="sd">            EOS-specific method, [J^2/mol^2/Pa/K**2]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;a_alpha and its first and second derivatives </span><span class="se">\</span>
<span class="s1">should be calculated by this method, in a user subclass.&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="GCEOS.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Generic method to calculate `T` from a specified `P` and `V`.</span>
<span class="sd">        Provides SciPy&#39;s `newton` solver, and iterates to solve the general</span>
<span class="sd">        equation for `P`, recalculating `a_alpha` as a function of temperature</span>
<span class="sd">        using `a_alpha_and_derivatives` each iteration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas - not applicable where a numerical solver is</span>
<span class="sd">            used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
            <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">P_calc</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">P_calc</span> <span class="o">-</span> <span class="n">P</span>
        <span class="k">return</span> <span class="n">newton</span><span class="p">(</span><span class="n">to_solve</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span></div>

<div class="viewcode-block" id="GCEOS.volume_solutions"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.volume_solutions">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">volume_solutions</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Solution of this form of the cubic EOS in terms of volumes. Returns</span>
<span class="sd">        three values, all with some complex part.  </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        b : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [m^3/mol]</span>
<span class="sd">        delta : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [m^3/mol]</span>
<span class="sd">        epsilon : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [m^6/mol^2]</span>
<span class="sd">        a_alpha : float</span>
<span class="sd">            Coefficient calculated by EOS-specific method, [J^2/mol^2/Pa]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Vs : list[float]</span>
<span class="sd">            Three possible molar volumes, [m^3/mol]</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Using explicit formulas, as can be derived in the following example,</span>
<span class="sd">        is faster than most numeric root finding techniques, and</span>
<span class="sd">        finds all values explicitly. It takes several seconds.</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V, R, b, a, delta, epsilon, alpha = symbols(&#39;P, T, V, R, b, a, delta, epsilon, alpha&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tc, Pc, omega = symbols(&#39;Tc, Pc, omega&#39;)</span>
<span class="sd">        &gt;&gt;&gt; CUBIC = R*T/(V-b) - a*alpha/(V*V + delta*V + epsilon) - P</span>
<span class="sd">        &gt;&gt;&gt; #solve(CUBIC, V)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">P</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x3</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x4</span>
            <span class="n">x6</span> <span class="o">=</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x7</span> <span class="o">=</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x8</span> <span class="o">=</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">x2</span>
            <span class="n">x9</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x0</span>
            <span class="n">x10</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span>
            <span class="n">x11</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x12</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="n">x2</span>
            <span class="n">x13</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">a_alpha</span>
            <span class="n">x14</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">x10</span>
            <span class="n">x15</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">x11</span>
            <span class="n">x16</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">x12</span>
            <span class="n">x17</span> <span class="o">=</span> <span class="o">-</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span>
            <span class="n">x18</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x17</span><span class="o">*</span><span class="n">x17</span>
            <span class="n">x19</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="mf">13.5</span><span class="o">*</span><span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="n">x6</span> <span class="o">+</span> <span class="n">x7</span> <span class="o">+</span> <span class="n">x8</span><span class="p">)</span> <span class="o">-</span> <span class="mf">4.5</span><span class="o">*</span><span class="n">x4</span><span class="o">*</span><span class="n">x9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">a_alpha</span> <span class="o">-</span> <span class="n">x10</span> <span class="o">+</span> <span class="n">x11</span> <span class="o">+</span> <span class="n">x12</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">x9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">x0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x13</span> <span class="o">-</span> <span class="n">x14</span> <span class="o">+</span> <span class="n">x15</span> <span class="o">+</span> <span class="n">x16</span> <span class="o">+</span> <span class="n">x18</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mf">9.</span><span class="o">*</span><span class="n">x0</span><span class="o">*</span><span class="n">x17</span><span class="o">*</span><span class="p">(</span><span class="n">a_alpha</span> <span class="o">+</span> <span class="n">x10</span> <span class="o">-</span> <span class="n">x11</span> <span class="o">-</span> <span class="n">x12</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x17</span><span class="o">*</span><span class="n">x17</span><span class="o">*</span><span class="n">x17</span><span class="o">*</span><span class="n">x9</span> <span class="o">-</span> <span class="mf">27.</span><span class="o">*</span><span class="p">(</span><span class="n">x6</span> <span class="o">+</span> <span class="n">x7</span> <span class="o">+</span> <span class="n">x8</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">x4</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">x9</span><span class="o">*</span><span class="n">x0</span><span class="p">)</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
            <span class="n">x20</span> <span class="o">=</span> <span class="n">x13</span> <span class="o">+</span> <span class="n">x14</span> <span class="o">-</span> <span class="n">x15</span> <span class="o">-</span> <span class="n">x16</span> <span class="o">-</span> <span class="n">x18</span>
            <span class="n">x22</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x5</span>
            <span class="n">x24</span> <span class="o">=</span> <span class="mf">1.7320508075688772</span><span class="n">j</span> <span class="o">+</span> <span class="mf">1.</span>
            <span class="n">x25</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">*</span><span class="n">x0</span><span class="o">*</span><span class="n">x20</span><span class="o">/</span><span class="n">x19</span>
            <span class="n">x26</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.7320508075688772</span><span class="n">j</span> <span class="o">+</span> <span class="mf">1.</span>
            <span class="k">return</span> <span class="p">[(</span><span class="n">x0</span><span class="o">*</span><span class="n">x20</span><span class="o">/</span><span class="n">x19</span> <span class="o">-</span> <span class="n">x19</span> <span class="o">+</span> <span class="n">x5</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">x19</span><span class="o">*</span><span class="n">x24</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">-</span> <span class="n">x25</span><span class="o">/</span><span class="n">x24</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">x19</span><span class="o">*</span><span class="n">x26</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">-</span> <span class="n">x25</span><span class="o">/</span><span class="n">x26</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">),</span>
                     <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">),</span>
                     <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">P</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">delta</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="p">)]</span></div>

    <span class="k">def</span> <span class="nf">derivatives_and_departures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        
        <span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">Cv_dep</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_derivatives_and_departures</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> 
                                             <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> 
                                             <span class="n">d2a_alpha_dT2</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="n">quick</span><span class="p">))</span>

        <span class="n">dV_dT</span> <span class="o">=</span> <span class="o">-</span><span class="n">dP_dT</span><span class="o">/</span><span class="n">dP_dV</span>
        <span class="n">dV_dP</span> <span class="o">=</span> <span class="o">-</span><span class="n">dV_dT</span><span class="o">/</span><span class="n">dP_dT</span> 
        <span class="n">dT_dV</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dV_dT</span>
        <span class="n">dT_dP</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dP_dT</span>
                
        <span class="n">d2V_dP2</span> <span class="o">=</span> <span class="o">-</span><span class="n">d2P_dV2</span><span class="o">*</span><span class="n">dP_dV</span><span class="o">**-</span><span class="mi">3</span>
        <span class="n">d2T_dP2</span> <span class="o">=</span> <span class="o">-</span><span class="n">d2P_dT2</span><span class="o">*</span><span class="n">dP_dT</span><span class="o">**-</span><span class="mi">3</span>
        
        <span class="n">d2T_dV2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d2P_dV2</span><span class="o">*</span><span class="n">dP_dT</span> <span class="o">-</span> <span class="n">dP_dV</span><span class="o">*</span><span class="n">d2P_dTdV</span><span class="p">)</span><span class="o">*</span><span class="n">dP_dT</span><span class="o">**-</span><span class="mi">2</span> 
                   <span class="o">+</span><span class="p">(</span><span class="n">d2P_dTdV</span><span class="o">*</span><span class="n">dP_dT</span> <span class="o">-</span> <span class="n">dP_dV</span><span class="o">*</span><span class="n">d2P_dT2</span><span class="p">)</span><span class="o">*</span><span class="n">dP_dT</span><span class="o">**-</span><span class="mi">3</span><span class="o">*</span><span class="n">dP_dV</span><span class="p">)</span>
        <span class="n">d2V_dT2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d2P_dT2</span><span class="o">*</span><span class="n">dP_dV</span> <span class="o">-</span> <span class="n">dP_dT</span><span class="o">*</span><span class="n">d2P_dTdV</span><span class="p">)</span><span class="o">*</span><span class="n">dP_dV</span><span class="o">**-</span><span class="mi">2</span>
                   <span class="o">+</span><span class="p">(</span><span class="n">d2P_dTdV</span><span class="o">*</span><span class="n">dP_dV</span> <span class="o">-</span> <span class="n">dP_dT</span><span class="o">*</span><span class="n">d2P_dV2</span><span class="p">)</span><span class="o">*</span><span class="n">dP_dV</span><span class="o">**-</span><span class="mi">3</span><span class="o">*</span><span class="n">dP_dT</span><span class="p">)</span>

        <span class="n">d2V_dPdT</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">d2P_dTdV</span><span class="o">*</span><span class="n">dP_dV</span> <span class="o">-</span> <span class="n">dP_dT</span><span class="o">*</span><span class="n">d2P_dV2</span><span class="p">)</span><span class="o">*</span><span class="n">dP_dV</span><span class="o">**-</span><span class="mi">3</span>
        <span class="n">d2T_dPdV</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">d2P_dTdV</span><span class="o">*</span><span class="n">dP_dT</span> <span class="o">-</span> <span class="n">dP_dV</span><span class="o">*</span><span class="n">d2P_dT2</span><span class="p">)</span><span class="o">*</span><span class="n">dP_dT</span><span class="o">**-</span><span class="mi">3</span>

        
        <span class="k">return</span> <span class="p">([</span><span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">dV_dT</span><span class="p">,</span> <span class="n">dV_dP</span><span class="p">,</span> <span class="n">dT_dV</span><span class="p">,</span> <span class="n">dT_dP</span><span class="p">],</span> 
                <span class="p">[</span><span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span><span class="p">,</span> <span class="n">d2V_dT2</span><span class="p">,</span> <span class="n">d2V_dP2</span><span class="p">,</span> <span class="n">d2T_dV2</span><span class="p">,</span> <span class="n">d2T_dP2</span><span class="p">],</span>
                <span class="p">[</span><span class="n">d2V_dPdT</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">d2T_dPdV</span><span class="p">],</span>
                <span class="p">[</span><span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">Cv_dep</span><span class="p">])</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">main_derivatives_and_departures</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">,</span>
                                        <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">b</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x0</span><span class="p">)</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">delta</span>
            <span class="n">x6</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span>
            <span class="n">x7</span> <span class="o">=</span> <span class="n">a_alpha</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x8</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span>
            <span class="n">x9</span> <span class="o">=</span> <span class="n">delta</span><span class="o">*</span><span class="n">delta</span>
            <span class="n">x10</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">epsilon</span> <span class="o">+</span> <span class="n">x9</span>
            <span class="n">x11</span> <span class="o">=</span> <span class="n">x10</span><span class="o">**-</span><span class="mf">0.5</span>
            <span class="n">x12</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x11</span><span class="o">*</span><span class="n">catanh</span><span class="p">(</span><span class="n">x11</span><span class="o">*</span><span class="n">x5</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
            <span class="n">x13</span> <span class="o">=</span> <span class="n">x10</span><span class="o">**-</span><span class="mf">0.5</span> 
            <span class="n">x14</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">delta</span><span class="o">*</span><span class="mf">0.5</span>
            <span class="n">x15</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="n">x13</span>
            <span class="n">x16</span> <span class="o">=</span> <span class="n">x13</span><span class="o">*</span><span class="n">x9</span><span class="o">*</span><span class="mf">0.5</span>
            <span class="n">dP_dT</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="n">x0</span> <span class="o">-</span> <span class="n">da_alpha_dT</span><span class="o">/</span><span class="n">x1</span>
            <span class="n">dP_dV</span> <span class="o">=</span> <span class="o">-</span><span class="n">x3</span><span class="o">*</span><span class="n">x4</span> <span class="o">+</span> <span class="n">x5</span><span class="o">*</span><span class="n">x7</span>
            <span class="n">d2P_dT2</span> <span class="o">=</span> <span class="o">-</span><span class="n">d2a_alpha_dT2</span><span class="o">/</span><span class="n">x1</span>
            <span class="n">d2P_dV2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">a_alpha</span><span class="o">*</span><span class="n">x5</span><span class="o">*</span><span class="n">x5</span><span class="o">*</span><span class="n">x6</span><span class="o">/</span><span class="n">x1</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x7</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x4</span><span class="o">/</span><span class="n">x0</span>
            <span class="n">d2P_dTdV</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">x4</span> <span class="o">+</span> <span class="n">da_alpha_dT</span><span class="o">*</span><span class="n">x5</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">H_dep</span> <span class="o">=</span> <span class="n">x12</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">da_alpha_dT</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x8</span>
            <span class="n">S_dep</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="n">V</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x8</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">da_alpha_dT</span><span class="o">*</span><span class="n">x12</span>  <span class="c1"># Consider Real part of the log only via log(x**2)/2 = Re(log(x))</span>
            <span class="n">Cv_dep</span> <span class="o">=</span> <span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">d2a_alpha_dT2</span><span class="o">*</span><span class="n">x13</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(((</span><span class="n">x14</span> <span class="o">-</span> <span class="n">x15</span> <span class="o">+</span> <span class="n">x16</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x14</span> <span class="o">+</span> <span class="n">x15</span> <span class="o">-</span> <span class="n">x16</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1"># Consider Real part of the log only via log(x**2)/2 = Re(log(x))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dP_dT</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">da_alpha_dT</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
            <span class="n">dP_dV</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">a_alpha</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">d2P_dT2</span> <span class="o">=</span> <span class="o">-</span><span class="n">d2a_alpha_dT2</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
            <span class="n">d2P_dV2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a_alpha</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a_alpha</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">d2P_dTdV</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span><span class="o">*</span><span class="n">da_alpha_dT</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">delta</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">H_dep</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">da_alpha_dT</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="p">)</span><span class="o">*</span><span class="n">catanh</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span><span class="o">.</span><span class="n">real</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)</span>
            <span class="n">S_dep</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">da_alpha_dT</span><span class="o">*</span><span class="n">catanh</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span><span class="o">.</span><span class="n">real</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)</span>
            <span class="n">Cv_dep</span> <span class="o">=</span> <span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">delta</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">delta</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">)))</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">delta</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">delta</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="p">))))</span><span class="o">*</span><span class="n">d2a_alpha_dT2</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">Cv_dep</span><span class="p">]</span>

<div class="viewcode-block" id="GCEOS.Psat"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.Psat">[docs]</a>    <span class="k">def</span> <span class="nf">Psat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">polish</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Generic method to calculate vapor pressure for a specified `T`.</span>
<span class="sd">        </span>
<span class="sd">        From Tc to 0.32Tc, uses a 10th order polynomial of the following form:</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \ln\frac{P_r}{T_r} = \sum_{k=0}^{10} C_k\left(\frac{\alpha}{T_r}</span>
<span class="sd">            -1\right)^{k}</span>
<span class="sd">                    </span>
<span class="sd">        If `polish` is True, SciPy&#39;s `newton` solver is launched with the </span>
<span class="sd">        calculated vapor pressure as an initial guess in an attempt to get more</span>
<span class="sd">        accuracy. This may not converge however.</span>
<span class="sd">        </span>
<span class="sd">        Results above the critical temperature are meaningless. A first-order </span>
<span class="sd">        polynomial is used to extrapolate under 0.32 Tc; however, there is </span>
<span class="sd">        normally not a volume solution to the EOS which can produce that</span>
<span class="sd">        low of a pressure.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        polish : bool, optional</span>
<span class="sd">            Whether to attempt to use a numerical solver to make the solution</span>
<span class="sd">            more precise or not</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Psat : float</span>
<span class="sd">            Vapor pressure, [Pa]</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        EOSs sharing the same `b`, `delta`, and `epsilon` have the same</span>
<span class="sd">        coefficient sets.</span>
<span class="sd">        </span>
<span class="sd">        All coefficients were derived with numpy&#39;s polyfit. The intersection</span>
<span class="sd">        between the polynomials is continuous, but there is a step change</span>
<span class="sd">        in its derivative.</span>
<span class="sd">        </span>
<span class="sd">        Form for the regression is inspired from [1]_.</span>
<span class="sd">                    </span>
<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Soave, G. &quot;Direct Calculation of Pure-Compound Vapour Pressures </span>
<span class="sd">           through Cubic Equations of State.&quot; Fluid Phase Equilibria 31, no. 2 </span>
<span class="sd">           (January 1, 1986): 203-7. doi:10.1016/0378-3812(86)90013-0. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="n">Tr</span> <span class="o">-</span> <span class="mf">1.</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat_coeffs_limiting</span> <span class="k">if</span> <span class="n">Tr</span> <span class="o">&lt;</span> <span class="mf">0.32</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat_coeffs</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">horner</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Psat</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">Tr</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
            <span class="c1"># coefficients sometimes overflow before T is lowered to 0.32Tr</span>
            <span class="n">polish</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">Psat</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">if</span> <span class="n">polish</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
                <span class="c1"># For use by newton. Only supports initialization with Tc, Pc and omega</span>
                <span class="c1"># ~200x slower and not guaranteed to converge</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">Tc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">)</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">fugacity_l</span> <span class="o">-</span> <span class="n">e</span><span class="o">.</span><span class="n">fugacity_g</span>
                <span class="k">return</span> <span class="n">err</span>
            <span class="n">Psat</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">to_solve</span><span class="p">,</span> <span class="n">Psat</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Psat</span></div>

<div class="viewcode-block" id="GCEOS.dPsat_dT"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.dPsat_dT">[docs]</a>    <span class="k">def</span> <span class="nf">dPsat_dT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Generic method to calculate the temperature derivative of vapor </span>
<span class="sd">        pressure for a specified `T`. Implements the analytical derivative</span>
<span class="sd">        of the two polynomials described in `Psat`.</span>
<span class="sd">        </span>
<span class="sd">        As with `Psat`, results above the critical temperature are meaningless. </span>
<span class="sd">        The first-order polynomial which is used to calculate it under 0.32 Tc</span>
<span class="sd">        may not be physicall meaningful, due to there normally not being a </span>
<span class="sd">        volume solution to the EOS which can produce that low of a pressure.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dPsat_dT : float</span>
<span class="sd">            Derivative of vapor pressure with respect to temperature, [Pa/K]</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        There is a small step change at 0.32 Tc for all EOS due to the two</span>
<span class="sd">        switch between polynomials at that point.</span>
<span class="sd">        </span>
<span class="sd">        Useful for calculating enthalpy of vaporization with the Clausius</span>
<span class="sd">        Clapeyron Equation. Derived with SymPy&#39;s diff and cse.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">a_alphas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">d_alpha_dT</span> <span class="o">=</span> <span class="n">a_alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">a_alphas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span>
        <span class="k">if</span> <span class="n">Tr</span> <span class="o">&gt;=</span> <span class="mf">0.32</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat_coeffs</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="n">T</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">*</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">x4</span>
            <span class="n">x6</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">x5</span>
            <span class="n">x7</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x8</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">x7</span>
            <span class="n">x9</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="n">x8</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d_alpha_dT</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="n">x9</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x3</span><span class="p">)</span> <span class="o">+</span> <span class="n">x4</span><span class="p">)</span> <span class="o">+</span> <span class="n">x5</span><span class="p">)</span> <span class="o">+</span> <span class="n">x6</span><span class="p">)</span> <span class="o">+</span> <span class="n">x7</span><span class="p">)</span> <span class="o">+</span> <span class="n">x8</span><span class="p">)</span> <span class="o">+</span> <span class="n">x9</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x2</span><span class="p">))))))))))</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat_coeffs_limiting</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">*</span><span class="n">d_alpha_dT</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">*</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">*</span><span class="n">alpha</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">*</span><span class="n">alpha</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span></div>
        
<div class="viewcode-block" id="GCEOS.V_l_sat"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.V_l_sat">[docs]</a>    <span class="k">def</span> <span class="nf">V_l_sat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate molar volume of the liquid phase along the</span>
<span class="sd">        saturation line.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        V_l_sat : float</span>
<span class="sd">            Liquid molar volume along the saturation line, [m^3/mol]</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Computers `Psat`, and then uses `volume_solutions` to obtain the three</span>
<span class="sd">        possible molar volumes. The lowest value is returned.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Psat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_solutions</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">)</span>
        <span class="c1"># Assume we can safely take the Vmax as gas, Vmin as l on the saturation line</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Vs</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="GCEOS.V_g_sat"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.V_g_sat">[docs]</a>    <span class="k">def</span> <span class="nf">V_g_sat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate molar volume of the vapor phase along the</span>
<span class="sd">        saturation line.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        V_g_sat : float</span>
<span class="sd">            Gas molar volume along the saturation line, [m^3/mol]</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Computers `Psat`, and then uses `volume_solutions` to obtain the three</span>
<span class="sd">        possible molar volumes. The highest value is returned.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Psat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_solutions</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">)</span>
        <span class="c1"># Assume we can safely take the Vmax as gas, Vmin as l on the saturation line</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Vs</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="GCEOS.Hvap"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS.Hvap">[docs]</a>    <span class="k">def</span> <span class="nf">Hvap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate enthalpy of vaporization for a pure fluid from</span>
<span class="sd">        an equation of state, without iteration.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \frac{dP^{sat}}{dT}=\frac{\Delta H_{vap}}{T(V_g - V_l)}</span>
<span class="sd">        </span>
<span class="sd">        Results above the critical temperature are meaningless. A first-order </span>
<span class="sd">        polynomial is used to extrapolate under 0.32 Tc; however, there is </span>
<span class="sd">        normally not a volume solution to the EOS which can produce that</span>
<span class="sd">        low of a pressure.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Hvap : float</span>
<span class="sd">            Increase in enthalpy needed for vaporization of liquid phase along </span>
<span class="sd">            the saturation line, [J/mol]</span>
<span class="sd">            </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Calculates vapor pressure and its derivative with `Psat` and `dPsat_dT`</span>
<span class="sd">        as well as molar volumes of the saturation liquid and vapor phase in</span>
<span class="sd">        the process.</span>
<span class="sd">        </span>
<span class="sd">        Very near the critical point this provides unrealistic results due to</span>
<span class="sd">        `Psat`&#39;s polynomials being insufficiently accurate.</span>
<span class="sd">                    </span>
<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Walas, Stanley M. Phase Equilibria in Chemical Engineering. </span>
<span class="sd">           Butterworth-Heinemann, 1985.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Psat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Psat</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">dPsat_dT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dPsat_dT</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a_alpha_and_derivatives</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">Vs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_solutions</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Psat</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">)</span>
        <span class="c1"># Assume we can safely take the Vmax as gas, Vmin as l on the saturation line</span>
        <span class="n">Vs</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">real</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Vs</span><span class="p">]</span>
        <span class="n">V_l</span><span class="p">,</span> <span class="n">V_g</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Vs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">Vs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dPsat_dT</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">V_g</span><span class="o">-</span><span class="n">V_l</span><span class="p">)</span></div>
        
    

    <span class="k">def</span> <span class="nf">to_TP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">T</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="ow">or</span> <span class="n">P</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="GCEOS_DUMMY"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.GCEOS_DUMMY">[docs]</a><span class="k">class</span> <span class="nc">GCEOS_DUMMY</span><span class="p">(</span><span class="n">GCEOS</span><span class="p">):</span>
    <span class="n">Tc</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">Pc</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span></div>

<span class="c1"># No named parameters</span>
<div class="viewcode-block" id="ALPHA_FUNCTIONS"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS">[docs]</a><span class="k">class</span> <span class="nc">ALPHA_FUNCTIONS</span><span class="p">(</span><span class="n">GCEOS</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Basic class with a number of attached alpha functions for different</span>
<span class="sd">    applications, all of which have no parameters attached. These alpha </span>
<span class="sd">    functions should be used for fitting purposes; new EOSs should have their</span>
<span class="sd">    alpha functions added here. The first and second derivatives should also</span>
<span class="sd">    be implemented. Efficient implementations are discouraged but possible.</span>
<span class="sd">    </span>
<span class="sd">    All parameters should be in `self.alpha_function_coeffs`. This object is</span>
<span class="sd">    inspired by the work of [1]_, where most of the alpha functions have been</span>
<span class="sd">    found.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Swap out the default alpha function from the SRK EOS, replace it the same,</span>
<span class="sd">    a new method that takes a manually specified coefficient.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = SRK(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; [eos.m, eos.a_alpha_and_derivatives(299)]</span>
<span class="sd">    [0.9326878999999999, (3.7271789178606376, -0.007332989159328508, 1.947612023379061e-05)]</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; class SRK_Soave_1972(SRK):</span>
<span class="sd">    ...     a_alpha_and_derivatives = ALPHA_FUNCTIONS.Soave_1972</span>
<span class="sd">    &gt;&gt;&gt; SRK_Soave_1972.alpha_function_coeffs = [0.9326878999999999]</span>
<span class="sd">    &gt;&gt;&gt; a = SRK_Soave_1972(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; a.a_alpha_and_derivatives(299)</span>
<span class="sd">    (3.7271789178606376, -0.007332989159328508, 1.947612023379061e-05)</span>
<span class="sd">        </span>


<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Young, Andr F., Fernando L. P. Pessoa, and Victor R. R. Ahn. </span>
<span class="sd">       &quot;Comparison of 20 Alpha Functions Applied in the PengRobinson Equation </span>
<span class="sd">       of State for Vapor Pressure Estimation.&quot; Industrial &amp; Engineering </span>
<span class="sd">       Chemistry Research 55, no. 22 (June 8, 2016): 6506-16. </span>
<span class="sd">       doi:10.1021/acs.iecr.6b00721.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
<div class="viewcode-block" id="ALPHA_FUNCTIONS.Soave_1972"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Soave_1972">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Soave_1972</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Soave (1972) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Same as `SRK.a_alpha_and_derivatives` but slower and</span>
<span class="sd">        requiring `alpha_function_coeffs` to be set. One coefficient needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = \left(c_{1} \left(- \sqrt{\frac{T}{Tc}} + 1\right)</span>
<span class="sd">            + 1\right)^{2}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Soave, Giorgio. &quot;Equilibrium Constants from a Modified Redlich-</span>
<span class="sd">           Kwong Equation of State.&quot; Chemical Engineering Science 27, no. 6 </span>
<span class="sd">           (June 1972): 1197-1203. doi:10.1016/0009-2509(72)80096-4.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Heyen"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Heyen">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Heyen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Heyen (1980) [1]_. Returns `a_alpha`, `da_alpha_dT`,  </span>
<span class="sd">        and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Two coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{c_{1} \left(- \left(\frac{T}{Tc}\right)^{c_{2}}</span>
<span class="sd">            + 1\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Heyen, G. Liquid and Vapor Properties from a Cubic Equation of </span>
<span class="sd">           State. In &quot;Proceedings of the 2nd International Conference on Phase </span>
<span class="sd">           Equilibria and Fluid Properties in the Chemical Industry&quot;. DECHEMA: </span>
<span class="sd">           Frankfurt, 1980; p 9-13.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c2</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c2</span> <span class="o">-</span> <span class="n">c2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>
        
<div class="viewcode-block" id="ALPHA_FUNCTIONS.Harmens_Knapp"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Harmens_Knapp">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Harmens_Knapp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Harmens and Knapp (1980) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Two coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = \left(c_{1} \left(- \sqrt{\frac{T}{Tc}} + 1\right) </span>
<span class="sd">            - c_{2} \left(1 - \frac{Tc}{T}\right) + 1\right)^{2}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Harmens, A., and H. Knapp. &quot;Three-Parameter Cubic Equation of </span>
<span class="sd">           State for Normal Substances.&quot; Industrial &amp; Engineering Chemistry </span>
<span class="sd">           Fundamentals 19, no. 3 (August 1, 1980): 291-94. </span>
<span class="sd">           doi:10.1021/i160075a010. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Tc</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Tc</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Tc</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Mathias"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Mathias">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Mathias</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Mathias (1983) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Two coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = \left(c_{1} \left(- \sqrt{\frac{T}{Tc}} + 1\right)</span>
<span class="sd">            - c_{2} \left(- \frac{T}{Tc} + 0.7\right) \left(- \frac{T}{Tc} </span>
<span class="sd">            + 1\right) + 1\right)^{2}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Mathias, Paul M. &quot;A Versatile Phase Equilibrium Equation of </span>
<span class="sd">           State.&quot; Industrial &amp; Engineering Chemistry Process Design and </span>
<span class="sd">           Development 22, no. 3 (July 1, 1983): 385-91. </span>
<span class="sd">           doi:10.1021/i200022a008. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">))</span> <span class="o">-</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.7</span><span class="o">-</span><span class="n">Tr</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="mi">8</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mf">0.7</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mf">0.7</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Mathias_Copeman"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Mathias_Copeman">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Mathias_Copeman</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Mathias and Copeman (1983) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = \left(c_{1} \left(- \sqrt{\frac{T}{Tc}} + 1\right)</span>
<span class="sd">            + c_{2} \left(- \sqrt{\frac{T}{Tc}} + 1\right)^{2} + c_{3} \left(</span>
<span class="sd">            - \sqrt{\frac{T}{Tc}} + 1\right)^{3} + 1\right)^{2}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Mathias, Paul M., and Thomas W. Copeman. &quot;Extension of the </span>
<span class="sd">           Peng-Robinson Equation of State to Complex Mixtures: Evaluation of </span>
<span class="sd">           the Various Forms of the Local Composition Concept.&quot; Fluid Phase </span>
<span class="sd">           Equilibria 13 (January 1, 1983): 91-108. </span>
<span class="sd">           doi:10.1016/0378-3812(83)80084-3. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">Tc</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Gibbons_Laughton"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Gibbons_Laughton">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Gibbons_Laughton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Gibbons and Laughton (1984) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Two coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = c_{1} \left(\frac{T}{Tc} - 1\right) + c_{2} </span>
<span class="sd">            \left(\sqrt{\frac{T}{Tc}} - 1\right) + 1</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Gibbons, Richard M., and Andrew P. Laughton. &quot;An Equation of </span>
<span class="sd">           State for Polar and Non-Polar Substances and Mixtures&quot; 80, no. 9 </span>
<span class="sd">           (January 1, 1984): 1019-38. doi:10.1039/F29848001019.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Soave_1984"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Soave_1984">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Soave_1984</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Soave (1984) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Two coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = c_{1} \left(- \frac{T}{Tc} + 1\right) + c_{2} \left(-1</span>
<span class="sd">            + \frac{Tc}{T}\right) + 1</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Soave, G. &quot;Improvement of the Van Der Waals Equation of State.&quot; </span>
<span class="sd">           Chemical Engineering Science 39, no. 2 (January 1, 1984): 357-69. </span>
<span class="sd">           doi:10.1016/0009-2509(84)80034-2.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Tc</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">Tc</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>
    <span class="c1"># &quot;Stryjek-Vera&quot; skipped, doesn&#39;t match PRSV or PRSV2</span>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Yu_Lu"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Yu_Lu">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Yu_Lu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Yu and Lu (1987) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Four coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = 10^{c_{4} \left(- \frac{T}{Tc} + 1\right) \left(</span>
<span class="sd">            \frac{T^{2} c_{3}}{Tc^{2}} + \frac{T c_{2}}{Tc} + c_{1}\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Yu, Jin-Min, and Benjamin C. -Y. Lu. &quot;A Three-Parameter Cubic </span>
<span class="sd">           Equation of State for Asymmetric Mixture Density Calculations.&quot; </span>
<span class="sd">           Fluid Phase Equilibria 34, no. 1 (January 1, 1987): 1-19. </span>
<span class="sd">           doi:10.1016/0378-3812(87)85047-1. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c2</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">))</span><span class="o">*</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Trebble_Bishnoi"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Trebble_Bishnoi">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Trebble_Bishnoi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Trebble and Bishnoi (1987) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. One coefficient needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{c_{1} \left(- \frac{T}{Tc} + 1\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Trebble, M. A., and P. R. Bishnoi. &quot;Development of a New Four-</span>
<span class="sd">           Parameter Cubic Equation of State.&quot; Fluid Phase Equilibria 35, no. 1</span>
<span class="sd">           (September 1, 1987): 1-18. doi:10.1016/0378-3812(87)80001-8.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*-</span><span class="n">c1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">c1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>
            
            
<div class="viewcode-block" id="ALPHA_FUNCTIONS.Melhem"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Melhem">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Melhem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Melhem et al. (1989) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Two coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{c_{1} \left(- \frac{T}{Tc} + 1\right) + c_{2} </span>
<span class="sd">            \left(- \sqrt{\frac{T}{Tc}} + 1\right)^{2}}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Melhem, Georges A., Riju Saini, and Bernard M. Goodwin. &quot;A </span>
<span class="sd">           Modified Peng-Robinson Equation of State.&quot; Fluid Phase Equilibria </span>
<span class="sd">           47, no. 2 (August 1, 1989): 189-237. </span>
<span class="sd">           doi:10.1016/0378-3812(89)80176-1. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Androulakis"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Androulakis">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Androulakis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Androulakis et al. (1989) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = c_{1} \left(- \left(\frac{T}{Tc}\right)^{\frac{2}{3}}</span>
<span class="sd">            + 1\right) + c_{2} \left(- \left(\frac{T}{Tc}\right)^{\frac{2}{3}} </span>
<span class="sd">            + 1\right)^{2} + c_{3} \left(- \left(\frac{T}{Tc}\right)^{</span>
<span class="sd">            \frac{2}{3}} + 1\right)^{3} + 1</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Androulakis, I. P., N. S. Kalospiros, and D. P. Tassios. </span>
<span class="sd">           &quot;Thermophysical Properties of Pure Polar and Nonpolar Compounds with</span>
<span class="sd">           a Modified VdW-711 Equation of State.&quot; Fluid Phase Equilibria 45, </span>
<span class="sd">           no. 2 (April 1, 1989): 135-63. doi:10.1016/0378-3812(89)80254-7. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Schwartzentruber"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Schwartzentruber">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Schwartzentruber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Schwartzentruber et al. (1990) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = \left(c_{4} \left(- \sqrt{\frac{T}{Tc}} + 1\right) </span>
<span class="sd">            - \left(- \sqrt{\frac{T}{Tc}} + 1\right) \left(\frac{T^{2} c_{3}}</span>
<span class="sd">            {Tc^{2}} + \frac{T c_{2}}{Tc} + c_{1}\right) + 1\right)^{2}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] J. Schwartzentruber, H. Renon, and S. Watanasiri, &quot;K-values for </span>
<span class="sd">           Non-Ideal Systems:An Easier Way,&quot; Chem. Eng., March 1990, 118-124.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Tr</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="n">c4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="o">-</span><span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Tr</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="n">c4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Tr</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">c2</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Tr</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Almeida"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Almeida">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Almeida</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Almeida et al. (1991) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{c_{1} \left(- \frac{T}{Tc} + 1\right) \left|{</span>
<span class="sd">            \frac{T}{Tc} - 1}\right|^{c_{2} - 1} + c_{3} \left(-1 </span>
<span class="sd">            + \frac{Tc}{T}\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Almeida, G. S., M. Aznar, and A. S. Telles. &quot;Uma Nova Forma de </span>
<span class="sd">           Dependncia Com a Temperatura Do Termo Atrativo de Equaes de </span>
<span class="sd">           Estado Cbicas.&quot; RBE, Rev. Bras. Eng., Cad. Eng. Quim 8 (1991): 95.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Note: For the second derivative, requires the use a CAS which can </span>
        <span class="c1"># handle the assumption that Tr-1 != 0.</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Tc</span><span class="o">/</span><span class="n">T</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">copysign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tc</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">Tc</span><span class="o">*</span><span class="n">c3</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Tc</span><span class="o">/</span><span class="n">T</span><span class="p">)))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">Tc</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="p">(</span><span class="n">Tc</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">copysign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">Tc</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">copysign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">copysign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Twu"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Twu">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Twu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Twu et al. (1991) [1]_. Returns `a_alpha`, </span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`  </span>
<span class="sd">        for more documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = \left(\frac{T}{Tc}\right)^{c_{3} \left(c_{2} </span>
<span class="sd">            - 1\right)} e^{c_{1} \left(- \left(\frac{T}{Tc}</span>
<span class="sd">            \right)^{c_{2} c_{3}} + 1\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Twu, Chorng H., David Bluck, John R. Cunningham, and John E. </span>
<span class="sd">           Coon. &quot;A Cubic Equation of State with a New Alpha Function and a </span>
<span class="sd">           New Mixing Rule.&quot; Fluid Phase Equilibria 69 (December 10, 1991): </span>
<span class="sd">           33-50. doi:10.1016/0378-3812(91)90024-2.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c1</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">-</span> <span class="n">c2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="n">c3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Soave_1993"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Soave_1993">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Soave_1993</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Soave (1983) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Two coefficient needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = c_{1} \left(- \frac{T}{Tc} + 1\right) + c_{2} </span>
<span class="sd">            \left(- \sqrt{\frac{T}{Tc}} + 1\right)^{2} + 1</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Soave, G. &quot;Improving the Treatment of Heavy Hydrocarbons by the </span>
<span class="sd">           SRK EOS.&quot; Fluid Phase Equilibria 84 (April 1, 1993): 339-42. </span>
<span class="sd">           doi:10.1016/0378-3812(93)85131-5.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Gasem"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Gasem">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Gasem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Gasem (2001) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{\left(- \left(\frac{T}{Tc}\right)^{c_{3}} + 1\right) </span>
<span class="sd">            \left(\frac{T c_{2}}{Tc} + c_{1}\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Gasem, K. A. M, W Gao, Z Pan, and R. L Robinson Jr. &quot;A Modified </span>
<span class="sd">           Temperature Dependence for the Peng-Robinson Equation of State.&quot; </span>
<span class="sd">           Fluid Phase Equilibria 181, no. 12 (May 25, 2001): 113-25. </span>
<span class="sd">           doi:10.1016/S0378-3812(01)00488-5.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="n">c2</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="n">c3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Coquelet"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Coquelet">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Coquelet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Coquelet et al. (2004) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{c_{1} \left(- \frac{T}{Tc} + 1\right) \left(c_{2} </span>
<span class="sd">            \left(- \sqrt{\frac{T}{Tc}} + 1\right)^{2} + c_{3} </span>
<span class="sd">            \left(- \sqrt{\frac{T}{Tc}} + 1\right)^{3} + 1\right)^{2}}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Coquelet, C., A. Chapoy, and D. Richon. &quot;Development of a New </span>
<span class="sd">           Alpha Function for the PengRobinson Equation of State: Comparative </span>
<span class="sd">           Study of Alpha Function Models for Pure Gases (Natural Gas </span>
<span class="sd">           Components) and Water-Gas Systems.&quot; International Journal of </span>
<span class="sd">           Thermophysics 25, no. 1 (January 1, 2004): 133-58. </span>
<span class="sd">           doi:10.1023/B:IJOT.0000022331.46865.2f.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">c1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Haghtalab"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Haghtalab">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Haghtalab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Haghtalab et al. (2010) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{\left(- c_{3}^{\log{\left (\frac{T}{Tc} \right )}} </span>
<span class="sd">            + 1\right) \left(- \frac{T c_{2}}{Tc} + c_{1}\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Haghtalab, A., M. J. Kamali, S. H. Mazloumi, and P. Mahmoodi. </span>
<span class="sd">           &quot;A New Three-Parameter Cubic Equation of State for Calculation </span>
<span class="sd">           Physical Properties and Vapor-liquid Equilibria.&quot; Fluid Phase </span>
<span class="sd">           Equilibria 293, no. 2 (June 25, 2010): 209-18. </span>
<span class="sd">           doi:10.1016/j.fluid.2010.03.029.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">c3</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c1</span><span class="p">)))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="n">c2</span><span class="o">*</span><span class="p">(</span><span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">c3</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c1</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">c3</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">c3</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">((</span><span class="n">c3</span><span class="o">**</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c1</span><span class="p">)))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Saffari"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Saffari">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Saffari</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Saffari and Zahedi (2013) [1]_. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Three coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{\frac{T c_{1}}{Tc} + c_{2} \log{\left (\frac{T}{Tc} </span>
<span class="sd">            \right )} + c_{3} \left(- \sqrt{\frac{T}{Tc}} + 1\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Saffari, Hamid, and Alireza Zahedi. &quot;A New Alpha-Function for </span>
<span class="sd">           the Peng-Robinson Equation of State: Application to Natural Gas.&quot; </span>
<span class="sd">           Chinese Journal of Chemical Engineering 21, no. 10 (October 1, </span>
<span class="sd">           2013): 1155-61. doi:10.1016/S1004-9541(13)60581-9.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="mi">2</span><span class="o">*</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">c2</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">c1</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="n">c3</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="ALPHA_FUNCTIONS.Chen_Yang"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.ALPHA_FUNCTIONS.Chen_Yang">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Chen_Yang</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives according to Hamid and Yang (2017) [1]_. Returns `a_alpha`,</span>
<span class="sd">        `da_alpha_dT`, and `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives`</span>
<span class="sd">        for more documentation. Seven coefficients needed.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            \alpha = e^{\left(- c_{3}^{\log{\left (\frac{T}{Tc} \right )}} </span>
<span class="sd">            + 1\right) \left(- \frac{T c_{2}}{Tc} + c_{1}\right)}</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [1] Chen, Zehua, and Daoyong Yang. &quot;Optimization of the Reduced </span>
<span class="sd">           Temperature Associated with PengRobinson Equation of State and </span>
<span class="sd">           Soave-Redlich-Kwong Equation of State To Improve Vapor Pressure </span>
<span class="sd">           Prediction for Heavy Hydrocarbon Compounds.&quot; Journal of Chemical &amp; </span>
<span class="sd">           Engineering Data, August 31, 2017. doi:10.1021/acs.jced.7b00496.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">,</span> <span class="n">c5</span><span class="p">,</span> <span class="n">c6</span><span class="p">,</span> <span class="n">c7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_function_coeffs</span>
        <span class="n">omega</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span>
        <span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c4</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c4</span><span class="o">*</span><span class="n">log</span><span class="p">((</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">c4</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">c4</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tc</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">Tc</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">c4</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c5</span> <span class="o">+</span> <span class="n">c6</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c7</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">c1</span> <span class="o">+</span> <span class="n">c2</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="n">c3</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div></div>



<div class="viewcode-block" id="PR"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PR">[docs]</a><span class="k">class</span> <span class="nc">PR</span><span class="p">(</span><span class="n">GCEOS</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Peng-Robinson cubic </span>
<span class="sd">    equation of state for a pure compound. Subclasses `CUBIC_EOS`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which calculates </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`.</span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{v-b}-\frac{a\alpha(T)}{v(v+b)+b(v-b)}</span>

<span class="sd">        a=0.45724\frac{R^2T_c^2}{P_c}</span>
<span class="sd">        </span>
<span class="sd">	  b=0.07780\frac{RT_c}{P_c}</span>

<span class="sd">        \alpha(T)=[1+\kappa(1-\sqrt{T_r})]^2</span>
<span class="sd">        </span>
<span class="sd">        \kappa=0.37464+1.54226\omega-0.26992\omega^2</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    T-P initialization, and exploring each phase&#39;s properties:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PR(Tc=507.6, Pc=3025000, omega=0.2975, T=400., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.V_l, eos.V_g</span>
<span class="sd">    (0.00015607313188529268, 0.0021418760907613724)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase</span>
<span class="sd">    &#39;l/g&#39;</span>
<span class="sd">    &gt;&gt;&gt; eos.H_dep_l, eos.H_dep_g</span>
<span class="sd">    (-26111.868721160878, -3549.2993749373945)</span>
<span class="sd">    &gt;&gt;&gt; eos.S_dep_l, eos.S_dep_g</span>
<span class="sd">    (-58.09842815106099, -6.439449710478305)</span>
<span class="sd">    &gt;&gt;&gt; eos.U_dep_l, eos.U_dep_g</span>
<span class="sd">    (-22942.157933046172, -2365.391545698767)</span>
<span class="sd">    &gt;&gt;&gt; eos.G_dep_l, eos.G_dep_g</span>
<span class="sd">    (-2872.497460736482, -973.5194907460723)</span>
<span class="sd">    &gt;&gt;&gt; eos.A_dep_l, eos.A_dep_g</span>
<span class="sd">    (297.21332737822377, 210.38833849255525)</span>
<span class="sd">    &gt;&gt;&gt; eos.beta_l, eos.beta_g</span>
<span class="sd">    (0.0026933709177837514, 0.01012322391117497)</span>
<span class="sd">    &gt;&gt;&gt; eos.kappa_l, eos.kappa_g</span>
<span class="sd">    (9.33572154382935e-09, 1.9710669809793307e-06)</span>
<span class="sd">    &gt;&gt;&gt; eos.Cp_minus_Cv_l, eos.Cp_minus_Cv_g</span>
<span class="sd">    (48.510145807408, 44.54414603000346)</span>
<span class="sd">    &gt;&gt;&gt; eos.Cv_dep_l, eos.Cp_dep_l</span>
<span class="sd">    (18.89210627002112, 59.08779227742912)</span>

<span class="sd">    P-T initialization, liquid phase, and round robin trip:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PR(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.00013022208100139945, -31134.740290463425, -72.47559475426019)</span>
<span class="sd">    </span>
<span class="sd">    T-V initialization, liquid phase:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PR(Tc=507.6, Pc=3025000, omega=0.2975, T=299., V=0.00013022208100139953)</span>
<span class="sd">    &gt;&gt;&gt; eos.P, eos.phase</span>
<span class="sd">    (1000000.0000020266, &#39;l&#39;)</span>
<span class="sd">    </span>
<span class="sd">    P-V initialization at same state:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PR(Tc=507.6, Pc=3025000, omega=0.2975, V=0.00013022208100139953, P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.T, eos.phase</span>
<span class="sd">    (298.99999999999926, &#39;l&#39;)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The constants in the expresions for `a` and `b` are given to full precision</span>
<span class="sd">    in the actual code, as derived in [3]_.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Peng, Ding-Yu, and Donald B. Robinson. &quot;A New Two-Constant Equation </span>
<span class="sd">       of State.&quot; Industrial &amp; Engineering Chemistry Fundamentals 15, no. 1 </span>
<span class="sd">       (February 1, 1976): 59-64. doi:10.1021/i160057a011.</span>
<span class="sd">    .. [2] Robinson, Donald B., Ding-Yu Peng, and Samuel Y-K Chung. &quot;The </span>
<span class="sd">       Development of the Peng - Robinson Equation and Its Application to Phase</span>
<span class="sd">       Equilibrium in a System Containing Methanol.&quot; Fluid Phase Equilibria 24,</span>
<span class="sd">       no. 1 (January 1, 1985): 25-41. doi:10.1016/0378-3812(85)87035-7. </span>
<span class="sd">    .. [3] Privat, R., and J.-N. Jaubert. &quot;PPR78, a Thermodynamic Model for the</span>
<span class="sd">       Prediction of Petroleum Fluid-Phase Behaviour,&quot; 11. EDP Sciences, 2011. </span>
<span class="sd">       doi:10.1051/jeep/201100011.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># constant part of `a`, </span>
    <span class="c1"># X = (-1 + (6*sqrt(2)+8)**Rational(1,3) - (6*sqrt(2)-8)**Rational(1,3))/3</span>
    <span class="c1"># (8*(5*X+1)/(49-37*X)).evalf(40)</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.4572355289213821893834601962251837888504</span>
    
    <span class="c1"># Constant part of `b`, (X/(X+3)).evalf(40)</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="mf">0.0777960739038884559718447100373331839711</span>
    
    <span class="n">Zc</span> <span class="o">=</span> <span class="mf">0.30740130869870386</span>
    
    <span class="c1"># Coefficients personally regressed, and tested against published solutions</span>
    <span class="c1"># fit with polyfit; 10th order found to be suitable and gains afterward are</span>
    <span class="c1"># tiny or negative</span>
    <span class="n">Psat_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9.6892347815183776e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00024435820311453189</span><span class="p">,</span> 
                   <span class="mf">0.0026885427128470565</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.017049496987961255</span><span class="p">,</span> 
                   <span class="mf">0.06971001627679084</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19625435197107072</span><span class="p">,</span> 
                   <span class="mf">0.39857709528021257</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.58702135332167182</span><span class="p">,</span> 
                   <span class="mf">0.51634619102133028</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.3504109815148495</span><span class="p">,</span> 
                   <span class="o">-</span><span class="mf">0.00013358770454510461</span><span class="p">]</span>
    <span class="n">Psat_coeffs_limiting</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.4758880164801873</span><span class="p">,</span> <span class="mf">0.7675486448347723</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.37464</span> <span class="o">+</span> <span class="mf">1.54226</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.26992</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="PR.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PR.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `kappa`, and `a`. </span>
<span class="sd">        </span>
<span class="sd">        For use in `solve_T`, returns only `a_alpha` if full is False.</span>

<span class="sd">        .. math::</span>
<span class="sd">            a\alpha = a \left(\kappa \left(- \frac{T^{0.5}}{Tc^{0.5}} </span>
<span class="sd">            + 1\right) + 1\right)^{2}</span>
<span class="sd">        </span>
<span class="sd">            \frac{d a\alpha}{dT} = - \frac{1.0 a \kappa}{T^{0.5} Tc^{0.5}}</span>
<span class="sd">            \left(\kappa \left(- \frac{T^{0.5}}{Tc^{0.5}} + 1\right) + 1\right)</span>

<span class="sd">            \frac{d^2 a\alpha}{dT^2} = 0.5 a \kappa \left(- \frac{1}{T^{1.5} </span>
<span class="sd">            Tc^{0.5}} \left(\kappa \left(\frac{T^{0.5}}{Tc^{0.5}} - 1\right)</span>
<span class="sd">            - 1\right) + \frac{\kappa}{T^{1.0} Tc^{1.0}}\right)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
                <span class="n">Tc</span><span class="p">,</span> <span class="n">kappa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">T</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">Tc</span><span class="o">**-</span><span class="mf">0.5</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="n">x0</span><span class="o">*</span><span class="n">x1</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span>
                
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="n">x0</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">T</span><span class="o">**-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="n">kappa</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">T</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="PR.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PR.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the PR</span>
<span class="sd">        EOS. Uses `Tc`, `a`, `b`, and `kappa` as well, obtained from the </span>
<span class="sd">        class&#39;s namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The exact solution can be derived as follows, and is excluded for </span>
<span class="sd">        breviety.</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V = symbols(&#39;P, T, V&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tc, Pc, omega = symbols(&#39;Tc, Pc, omega&#39;)</span>
<span class="sd">        &gt;&gt;&gt; R, a, b, kappa = symbols(&#39;R, a, b, kappa&#39;)</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; a_alpha = a*(1 + kappa*(1-sqrt(T/Tc)))**2</span>
<span class="sd">        &gt;&gt;&gt; PR_formula = R*T/(V-b) - a_alpha/(V*(V+b)+b*(V-b)) - P</span>
<span class="sd">        &gt;&gt;&gt; #solve(PR_formula, T)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">kappa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">V</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">kappa</span><span class="o">*</span><span class="n">kappa</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">x4</span>
            <span class="n">x6</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x7</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x8</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x9</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x8</span>
            <span class="n">x10</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">x4</span>
            <span class="n">x11</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">x10</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x5</span> <span class="o">+</span> <span class="n">x7</span> <span class="o">-</span> <span class="n">x9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">x12</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x0</span>
            <span class="n">x13</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">R</span>
            <span class="n">x14</span> <span class="o">=</span> <span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span>
            <span class="n">x15</span> <span class="o">=</span> <span class="n">x13</span><span class="o">*</span><span class="n">x14</span>
            <span class="n">x16</span> <span class="o">=</span> <span class="n">x8</span><span class="o">*</span><span class="n">x8</span>
            <span class="n">x17</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span>
            <span class="n">x18</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x19</span> <span class="o">=</span> <span class="n">x17</span><span class="o">*</span><span class="n">x18</span>
            <span class="n">x20</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">V</span>
            <span class="n">x21</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x22</span> <span class="o">=</span> <span class="n">x8</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x23</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">x22</span>
            <span class="n">x24</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">x20</span>
            <span class="n">x25</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x26</span> <span class="o">=</span> <span class="n">x25</span><span class="o">*</span><span class="n">x8</span>
            <span class="n">x27</span> <span class="o">=</span> <span class="n">x26</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x28</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x25</span>
            <span class="n">x29</span> <span class="o">=</span> <span class="n">x28</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x30</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x8</span>
            <span class="n">x31</span> <span class="o">=</span> <span class="mf">6.</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">x27</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">x29</span> <span class="o">+</span> <span class="n">x0</span><span class="o">*</span><span class="n">x13</span><span class="o">*</span><span class="n">x14</span><span class="o">*</span><span class="n">x30</span> <span class="o">+</span> <span class="n">x0</span><span class="o">*</span><span class="n">x19</span> <span class="o">+</span> <span class="n">x12</span><span class="o">*</span><span class="n">x15</span> <span class="o">+</span> <span class="n">x15</span><span class="o">*</span><span class="n">x16</span> <span class="o">-</span> <span class="n">x15</span><span class="o">*</span><span class="n">x23</span> <span class="o">+</span> <span class="n">x15</span><span class="o">*</span><span class="n">x24</span> <span class="o">-</span> <span class="n">x19</span><span class="o">*</span><span class="n">x6</span> <span class="o">+</span> <span class="n">x19</span><span class="o">*</span><span class="n">x8</span> <span class="o">-</span> <span class="n">x20</span><span class="o">*</span><span class="n">x21</span> <span class="o">-</span> <span class="n">x21</span><span class="o">*</span><span class="n">x22</span>
            <span class="n">x32</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">b</span>
            <span class="n">x33</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="p">)</span>
            <span class="n">x34</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">x2</span>
            <span class="n">x35</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">x5</span>
            <span class="n">x36</span> <span class="o">=</span> <span class="n">x25</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x37</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">x10</span>
            <span class="n">x38</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span>
            <span class="n">x39</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">x17</span>
            <span class="n">x40</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x41</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">x17</span>
            <span class="n">x42</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x3</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">Tc</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">x11</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x32</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x6</span> <span class="o">-</span> <span class="n">x8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">x7</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">x9</span> <span class="o">+</span> <span class="n">x25</span> <span class="o">+</span> <span class="n">x33</span> <span class="o">+</span> <span class="n">x34</span> <span class="o">+</span> <span class="n">x35</span> <span class="o">+</span> <span class="n">x36</span> <span class="o">-</span> <span class="n">x37</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">kappa</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="n">x31</span><span class="o">*</span><span class="n">x32</span><span class="o">*</span><span class="p">((</span><span class="mf">4.</span><span class="o">*</span><span class="n">V</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="p">)</span> <span class="o">+</span> <span class="n">x0</span><span class="o">*</span><span class="n">x33</span> <span class="o">-</span> <span class="n">x0</span><span class="o">*</span><span class="n">x35</span> <span class="o">+</span> <span class="n">x12</span><span class="o">*</span><span class="n">x38</span> <span class="o">+</span> <span class="n">x16</span><span class="o">*</span><span class="n">x38</span> <span class="o">+</span> <span class="n">x18</span><span class="o">*</span><span class="n">x39</span> <span class="o">-</span> <span class="n">x18</span><span class="o">*</span><span class="n">x41</span> <span class="o">-</span> <span class="n">x20</span><span class="o">*</span><span class="n">x42</span> <span class="o">-</span> <span class="n">x22</span><span class="o">*</span><span class="n">x42</span> <span class="o">-</span> <span class="n">x23</span><span class="o">*</span><span class="n">x38</span> <span class="o">+</span> <span class="n">x24</span><span class="o">*</span><span class="n">x38</span> <span class="o">+</span> <span class="n">x25</span><span class="o">*</span><span class="n">x6</span> <span class="o">-</span> <span class="n">x26</span> <span class="o">-</span> <span class="n">x27</span> <span class="o">+</span> <span class="n">x28</span> <span class="o">+</span> <span class="n">x29</span> <span class="o">+</span> <span class="n">x3</span><span class="o">*</span><span class="n">x39</span> <span class="o">-</span> <span class="n">x3</span><span class="o">*</span><span class="n">x41</span> <span class="o">+</span> <span class="n">x30</span><span class="o">*</span><span class="n">x34</span> <span class="o">-</span> <span class="n">x33</span><span class="o">*</span><span class="n">x8</span> <span class="o">+</span> <span class="n">x36</span><span class="o">*</span><span class="n">x6</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x37</span><span class="o">*</span><span class="n">x8</span> <span class="o">+</span> <span class="n">x39</span><span class="o">*</span><span class="n">x40</span> <span class="o">-</span> <span class="n">x40</span><span class="o">*</span><span class="n">x41</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x11</span><span class="o">*</span><span class="n">x31</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tc</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">*</span><span class="n">sqrt</span><span class="p">((</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">kappa</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">kappa</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span></div></div>
    
        
    
    
    
<span class="c1">#a = PR(Tc=507.6, Pc=3025000, omega=0.2975, T=400., P=1E6)</span>
<span class="c1">#print(a.d2V_dPdT_g, a.V_g)</span>
<span class="c1">##</span>
<span class="c1">#b = PR(Tc=507.6, Pc=3025000, omega=0.2975, T=299., V=0.00013022208100139953)</span>
<span class="c1">#print(b.d2V_dPdT_l, b.PIP_l, b.V_l, b.P)</span>
<span class="c1">#</span>
<span class="c1">#c = PR(Tc=507.6, Pc=3025000, omega=0.2975, V=0.00013022208100139953, P=1E6)</span>
<span class="c1">#print(c.d2V_dPdT_l, c.PIP_l, c.V_l, c.T)</span>


<div class="viewcode-block" id="PR78"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PR78">[docs]</a><span class="k">class</span> <span class="nc">PR78</span><span class="p">(</span><span class="n">PR</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Peng-Robinson cubic </span>
<span class="sd">    equation of state for a pure compound according to the 1978 variant.</span>
<span class="sd">    Subclasses `PR`, which provides everything except the variable `kappa`.</span>
<span class="sd">    Solves the EOS on initialization. See `PR` for further documentation.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{v-b}-\frac{a\alpha(T)}{v(v+b)+b(v-b)}</span>

<span class="sd">        a=0.45724\frac{R^2T_c^2}{P_c}</span>
<span class="sd">        </span>
<span class="sd">	  b=0.07780\frac{RT_c}{P_c}</span>

<span class="sd">        \alpha(T)=[1+\kappa(1-\sqrt{T_r})]^2</span>
<span class="sd">        </span>
<span class="sd">        \kappa_i = 0.37464+1.54226\omega_i-0.26992\omega_i^2 \text{ if } \omega_i</span>
<span class="sd">        \le 0.491</span>
<span class="sd">        </span>
<span class="sd">        \kappa_i = 0.379642 + 1.48503 \omega_i - 0.164423\omega_i^2 + 0.016666</span>
<span class="sd">        \omega_i^3 \text{ if } \omega_i &gt; 0.491</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    P-T initialization (furfuryl alcohol), liquid phase:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PR78(Tc=632, Pc=5350000, omega=0.734, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 8.351960066075009e-05, -63764.649480508735, -130.73710891262687)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This variant is recommended over the original.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Robinson, Donald B, and Ding-Yu Peng. The Characterization of the </span>
<span class="sd">       Heptanes and Heavier Fractions for the GPA Peng-Robinson Programs. </span>
<span class="sd">       Tulsa, Okla.: Gas Processors Association, 1978.</span>
<span class="sd">    .. [2] Robinson, Donald B., Ding-Yu Peng, and Samuel Y-K Chung. &quot;The </span>
<span class="sd">       Development of the Peng - Robinson Equation and Its Application to Phase</span>
<span class="sd">       Equilibrium in a System Containing Methanol.&quot; Fluid Phase Equilibria 24,</span>
<span class="sd">       no. 1 (January 1, 1985): 25-41. doi:10.1016/0378-3812(85)87035-7.  </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>

        <span class="k">if</span> <span class="n">omega</span> <span class="o">&lt;=</span> <span class="mf">0.491</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.37464</span> <span class="o">+</span> <span class="mf">1.54226</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.26992</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.379642</span> <span class="o">+</span> <span class="mf">1.48503</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.164423</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.016666</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">3</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span></div>


<div class="viewcode-block" id="PRSV"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PRSV">[docs]</a><span class="k">class</span> <span class="nc">PRSV</span><span class="p">(</span><span class="n">PR</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Peng-Robinson-Stryjek-Vera equations of state for</span>
<span class="sd">    a pure compound as given in [1]_. The same as the Peng-Robinson EOS,</span>
<span class="sd">    except with a different `kappa` formula and with an optional fit parameter.</span>
<span class="sd">    Subclasses `PR`, which provides only several constants. See `PR` for </span>
<span class="sd">    further documentation and examples.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{v-b}-\frac{a\alpha(T)}{v(v+b)+b(v-b)}</span>

<span class="sd">        a=0.45724\frac{R^2T_c^2}{P_c}</span>
<span class="sd">        </span>
<span class="sd">	  b=0.07780\frac{RT_c}{P_c}</span>

<span class="sd">        \alpha(T)=[1+\kappa(1-\sqrt{T_r})]^2</span>
<span class="sd">        </span>
<span class="sd">        \kappa = \kappa_0 + \kappa_1(1 + T_r^{0.5})(0.7 - T_r)</span>
<span class="sd">        </span>
<span class="sd">        \kappa_0 = 0.378893 + 1.4897153\omega - 0.17131848\omega^2 </span>
<span class="sd">        + 0.0196554\omega^3</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>
<span class="sd">    kappa1 : float, optional</span>
<span class="sd">        Fit parameter; available in [1]_ for over 90 compounds, [-]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    P-T initialization (hexane, with fit parameter in [1]_), liquid phase:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PRSV(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6, kappa1=0.05104)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.000130126869448406, -31698.916002476693, -74.16749024350415)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    [1]_ recommends that `kappa1` be set to 0 for Tr &gt; 0.7. This is not done by </span>
<span class="sd">    default; the class boolean `kappa1_Tr_limit` may be set to True and the</span>
<span class="sd">    problem re-solved with that specified if desired. `kappa1_Tr_limit` is not</span>
<span class="sd">    supported for P-V inputs.</span>
<span class="sd">    </span>
<span class="sd">    Solutions for P-V solve for `T` with SciPy&#39;s `newton` solver, as there is no</span>
<span class="sd">    analytical solution for `T`</span>
<span class="sd">    </span>
<span class="sd">    [2]_ and [3]_ are two more resources documenting the PRSV EOS. [4]_ lists</span>
<span class="sd">    `kappa` values for 69 additional compounds. See also `PRSV2`. Note that</span>
<span class="sd">    tabulated `kappa` values should be used with the critical parameters used</span>
<span class="sd">    in their fits. Both [1]_ and [4]_ only considered vapor pressure in fitting</span>
<span class="sd">    the parameter.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Stryjek, R., and J. H. Vera. &quot;PRSV: An Improved Peng-Robinson </span>
<span class="sd">       Equation of State for Pure Compounds and Mixtures.&quot; The Canadian Journal</span>
<span class="sd">       of Chemical Engineering 64, no. 2 (April 1, 1986): 323-33. </span>
<span class="sd">       doi:10.1002/cjce.5450640224. </span>
<span class="sd">    .. [2] Stryjek, R., and J. H. Vera. &quot;PRSV - An Improved Peng-Robinson </span>
<span class="sd">       Equation of State with New Mixing Rules for Strongly Nonideal Mixtures.&quot;</span>
<span class="sd">       The Canadian Journal of Chemical Engineering 64, no. 2 (April 1, 1986): </span>
<span class="sd">       334-40. doi:10.1002/cjce.5450640225.  </span>
<span class="sd">    .. [3] Stryjek, R., and J. H. Vera. &quot;Vapor-liquid Equilibrium of </span>
<span class="sd">       Hydrochloric Acid Solutions with the PRSV Equation of State.&quot; Fluid </span>
<span class="sd">       Phase Equilibria 25, no. 3 (January 1, 1986): 279-90. </span>
<span class="sd">       doi:10.1016/0378-3812(86)80004-8. </span>
<span class="sd">    .. [4] Proust, P., and J. H. Vera. &quot;PRSV: The Stryjek-Vera Modification of </span>
<span class="sd">       the Peng-Robinson Equation of State. Parameters for Other Pure Compounds</span>
<span class="sd">       of Industrial Interest.&quot; The Canadian Journal of Chemical Engineering </span>
<span class="sd">       67, no. 1 (February 1, 1989): 170-73. doi:10.1002/cjce.5450670125.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">kappa1_Tr_limit</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kappa1</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kappa1&#39;</span><span class="p">:</span> <span class="n">kappa1</span><span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span> <span class="o">=</span> <span class="mf">0.378893</span> <span class="o">+</span> <span class="mf">1.4897153</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.17131848</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.0196554</span><span class="o">*</span><span class="n">omega</span><span class="o">**</span><span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_sufficient_inputs</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">:</span>
            <span class="c1"># Deal with T-solution here; does NOT support kappa1_Tr_limit.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span> <span class="o">=</span> <span class="n">kappa1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
            <span class="n">Tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa1_Tr_limit</span> <span class="ow">and</span> <span class="n">Tr</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span> <span class="o">=</span> <span class="n">kappa1</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.7</span> <span class="o">-</span> <span class="n">Tr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="PRSV.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PRSV.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the PRSV</span>
<span class="sd">        EOS. Uses `Tc`, `a`, `b`, `kappa0`  and `kappa` as well, obtained from  </span>
<span class="sd">        the class&#39;s namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (somewhat faster) or </span>
<span class="sd">            individual formulas.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Not guaranteed to produce a solution. There are actually two solution,</span>
<span class="sd">        one much higher than normally desired; it is possible the solver could</span>
<span class="sd">        converge on this.        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">kappa0</span><span class="p">,</span> <span class="n">kappa1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">b</span>
            <span class="n">R_x0</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="n">x0</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100.</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x0</span><span class="p">))</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">*</span><span class="n">kappa0</span>
            <span class="n">kappa110</span> <span class="o">=</span> <span class="n">kappa1</span><span class="o">*</span><span class="mf">10.</span>
            <span class="n">kappa17</span> <span class="o">=</span> <span class="n">kappa1</span><span class="o">*</span><span class="mf">7.</span>
            <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">R_x0</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">x4</span> <span class="o">-</span> <span class="p">(</span><span class="n">kappa110</span><span class="o">*</span><span class="n">x1</span> <span class="o">-</span> <span class="n">kappa17</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x3</span><span class="p">)</span> <span class="o">-</span> <span class="n">P</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
                <span class="n">P_calc</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">P_calc</span> <span class="o">-</span> <span class="n">P</span>
        <span class="k">return</span> <span class="n">newton</span><span class="p">(</span><span class="n">to_solve</span><span class="p">,</span> <span class="n">Tc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span></div>

<div class="viewcode-block" id="PRSV.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PRSV.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `kappa0`, `kappa1`, and </span>
<span class="sd">        `a`. </span>
<span class="sd">        </span>
<span class="sd">        For use in root-finding, returns only `a_alpha` if full is False.</span>

<span class="sd">        The `a_alpha` function is shown below; its first and second derivatives</span>
<span class="sd">        are long available through the SymPy expression under it.</span>

<span class="sd">        .. math::</span>
<span class="sd">            a\alpha = a \left(\left(\kappa_{0} + \kappa_{1} \left(\sqrt{\frac{</span>
<span class="sd">            T}{Tc}} + 1\right) \left(- \frac{T}{Tc} + \frac{7}{10}\right)</span>
<span class="sd">            \right) \left(- \sqrt{\frac{T}{Tc}} + 1\right) + 1\right)^{2}</span>
<span class="sd">            </span>
<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V = symbols(&#39;P, T, V&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tc, Pc, omega = symbols(&#39;Tc, Pc, omega&#39;)</span>
<span class="sd">        &gt;&gt;&gt; R, a, b, kappa0, kappa1 = symbols(&#39;R, a, b, kappa0, kappa1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; kappa = kappa0 + kappa1*(1 + sqrt(T/Tc))*(Rational(7, 10)-T/Tc)</span>
<span class="sd">        &gt;&gt;&gt; a_alpha = a*(1 + kappa*(1-sqrt(T/Tc)))**2</span>
<span class="sd">        &gt;&gt;&gt; # diff(a_alpha, T)</span>
<span class="sd">        &gt;&gt;&gt; # diff(a_alpha, T, 2)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">kappa0</span><span class="p">,</span> <span class="n">kappa1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x4</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">*</span><span class="n">x1</span> <span class="o">-</span> <span class="mf">7.</span>
                <span class="n">x5</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="mf">1.</span>
                <span class="n">x6</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">*</span><span class="n">kappa0</span> <span class="o">-</span> <span class="n">kappa1</span><span class="o">*</span><span class="n">x4</span><span class="o">*</span><span class="n">x5</span>
                <span class="n">x7</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="n">x6</span>
                <span class="n">x8</span> <span class="o">=</span> <span class="n">x7</span><span class="o">*</span><span class="mf">0.1</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x10</span> <span class="o">=</span> <span class="n">x6</span><span class="o">/</span><span class="n">T</span>
                <span class="n">x11</span> <span class="o">=</span> <span class="n">kappa1</span><span class="o">*</span><span class="n">x3</span>
                <span class="n">x12</span> <span class="o">=</span> <span class="n">x4</span><span class="o">/</span><span class="n">T</span>
                <span class="n">x13</span> <span class="o">=</span> <span class="mf">20.</span><span class="o">/</span><span class="n">Tc</span><span class="o">*</span><span class="n">x5</span> <span class="o">+</span> <span class="n">x12</span><span class="o">*</span><span class="n">x2</span>
                <span class="n">x14</span> <span class="o">=</span> <span class="o">-</span><span class="n">x10</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x11</span><span class="o">*</span><span class="n">x13</span>
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x8</span><span class="o">*</span><span class="n">x8</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x14</span><span class="o">*</span><span class="n">x8</span><span class="o">*</span><span class="mf">0.1</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x14</span><span class="o">*</span><span class="n">x14</span> <span class="o">-</span> <span class="n">x2</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="p">(</span><span class="n">x7</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">kappa1</span><span class="o">*</span><span class="n">x13</span> <span class="o">+</span> <span class="n">x10</span> <span class="o">+</span> <span class="n">x11</span><span class="o">*</span><span class="p">(</span><span class="mf">40.</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">x12</span><span class="p">)))</span><span class="o">/</span><span class="mf">200.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa0</span> <span class="o">+</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mf">0.7</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">kappa0</span> <span class="o">-</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">7</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">10</span><span class="o">*</span><span class="n">kappa0</span> <span class="o">-</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">7</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="mi">40</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">kappa0</span> <span class="o">-</span> <span class="n">kappa1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="mi">7</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="mi">200</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div></div>

            
<div class="viewcode-block" id="PRSV2"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PRSV2">[docs]</a><span class="k">class</span> <span class="nc">PRSV2</span><span class="p">(</span><span class="n">PR</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Peng-Robinson-Stryjek-Vera 2 equations of state </span>
<span class="sd">    for a pure compound as given in [1]_. The same as the Peng-Robinson EOS,</span>
<span class="sd">    except with a different `kappa` formula and with three fit parameters.</span>
<span class="sd">    Subclasses `PR`, which provides only several constants. See `PR` for </span>
<span class="sd">    further documentation and examples. PRSV provides only one constant.</span>
<span class="sd">    </span>
<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{v-b}-\frac{a\alpha(T)}{v(v+b)+b(v-b)}</span>

<span class="sd">        a=0.45724\frac{R^2T_c^2}{P_c}</span>
<span class="sd">        </span>
<span class="sd">	  b=0.07780\frac{RT_c}{P_c}</span>

<span class="sd">        \alpha(T)=[1+\kappa(1-\sqrt{T_r})]^2</span>
<span class="sd">        </span>
<span class="sd">        \kappa = \kappa_0 + [\kappa_1 + \kappa_2(\kappa_3 - T_r)(1-T_r^{0.5})]</span>
<span class="sd">        (1 + T_r^{0.5})(0.7 - T_r)</span>
<span class="sd">        </span>
<span class="sd">        \kappa_0 = 0.378893 + 1.4897153\omega - 0.17131848\omega^2 </span>
<span class="sd">        + 0.0196554\omega^3</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>
<span class="sd">    kappa1 : float, optional</span>
<span class="sd">        Fit parameter; available in [1]_ for over 90 compounds, [-]</span>
<span class="sd">    kappa2 : float, optional</span>
<span class="sd">        Fit parameter; available in [1]_ for over 90 compounds, [-]</span>
<span class="sd">    kappa : float, optional</span>
<span class="sd">        Fit parameter; available in [1]_ for over 90 compounds, [-]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    P-T initialization (hexane, with fit parameter in [1]_), liquid phase:</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; eos = PRSV2(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6, kappa1=0.05104, kappa2=0.8634, kappa3=0.460)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.00013018821346475235, -31496.173493225797, -73.61525801151421)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Solutions for P-V solve for `T` with SciPy&#39;s `newton` solver, as there is </span>
<span class="sd">    no analytical solution for `T`</span>
<span class="sd">    </span>
<span class="sd">    Note that tabulated `kappa` values should be used with the critical </span>
<span class="sd">    parameters used in their fits. [1]_ considered only vapor </span>
<span class="sd">    pressure in fitting the parameter.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Stryjek, R., and J. H. Vera. &quot;PRSV2: A Cubic Equation of State for </span>
<span class="sd">       Accurate Vapor-liquid Equilibria Calculations.&quot; The Canadian Journal of </span>
<span class="sd">       Chemical Engineering 64, no. 5 (October 1, 1986): 820-26. </span>
<span class="sd">       doi:10.1002/cjce.5450640516. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kappa1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kappa2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kappa3</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_sufficient_inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kappa1&#39;</span><span class="p">:</span> <span class="n">kappa1</span><span class="p">,</span> <span class="s1">&#39;kappa2&#39;</span><span class="p">:</span> <span class="n">kappa2</span><span class="p">,</span> <span class="s1">&#39;kappa3&#39;</span><span class="p">:</span> <span class="n">kappa3</span><span class="p">}</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span> <span class="o">=</span> <span class="mf">0.378893</span> <span class="o">+</span> <span class="mf">1.4897153</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.17131848</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span> <span class="o">+</span> <span class="mf">0.0196554</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa3</span> <span class="o">=</span> <span class="n">kappa1</span><span class="p">,</span> <span class="n">kappa2</span><span class="p">,</span> <span class="n">kappa3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">:</span>
            <span class="c1"># Deal with T-solution here</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
        <span class="n">Tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kappa3</span> 
                                     <span class="o">-</span> <span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Tr</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.7</span> <span class="o">-</span> <span class="n">Tr</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="PRSV2.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PRSV2.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the PRSV2</span>
<span class="sd">        EOS. Uses `Tc`, `a`, `b`, `kappa0`, `kappa1`, `kappa2`, and `kappa3`</span>
<span class="sd">        as well, obtained from the class&#39;s namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (somewhat faster) or </span>
<span class="sd">            individual formulas.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        </span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Not guaranteed to produce a solution. There are actually 8 solutions,</span>
<span class="sd">        six with an imaginary component at a tested point. The two temperature</span>
<span class="sd">        solutions are quite far apart, with one much higher than the other;</span>
<span class="sd">        it is possible the solver could converge on the higher solution, so use</span>
<span class="sd">        `T` inputs with care. This extra solution is a perfectly valid one</span>
<span class="sd">        however.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Generic solution takes 72 vs 56 microseconds for the optimized version below</span>
<span class="c1">#        return super(PR, self).solve_T(P, V, quick=quick) </span>
        <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">kappa0</span><span class="p">,</span> <span class="n">kappa1</span><span class="p">,</span> <span class="n">kappa2</span><span class="p">,</span> <span class="n">kappa3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa3</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">b</span>
            <span class="n">R_x0</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="n">x0</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100.</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">x0</span><span class="p">))</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">*</span><span class="n">kappa0</span>
            <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">R_x0</span><span class="o">*</span><span class="n">T</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x3</span><span class="o">*</span><span class="p">(</span><span class="n">x4</span> <span class="o">-</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa3</span> <span class="o">+</span> <span class="n">x1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mf">10.</span><span class="o">*</span><span class="n">x1</span> <span class="o">-</span> <span class="mf">7.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">))</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x5</span><span class="p">)</span> <span class="o">-</span> <span class="n">P</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
                <span class="n">P_calc</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">P_calc</span> <span class="o">-</span> <span class="n">P</span>
        <span class="k">return</span> <span class="n">newton</span><span class="p">(</span><span class="n">to_solve</span><span class="p">,</span> <span class="n">Tc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span></div>


<div class="viewcode-block" id="PRSV2.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.PRSV2.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `kappa0`, `kappa1`,</span>
<span class="sd">        `kappa2`, `kappa3`, and `a`. </span>
<span class="sd">        </span>
<span class="sd">        For use in `solve_T`, returns only `a_alpha` if full is False.</span>
<span class="sd">        </span>
<span class="sd">        The first and second derivatives of `a_alpha` are available through the</span>
<span class="sd">        following SymPy expression.</span>

<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V = symbols(&#39;P, T, V&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tc, Pc, omega = symbols(&#39;Tc, Pc, omega&#39;)</span>
<span class="sd">        &gt;&gt;&gt; R, a, b, kappa0, kappa1, kappa2, kappa3 = symbols(&#39;R, a, b, kappa0, kappa1, kappa2, kappa3&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tr = T/Tc</span>
<span class="sd">        &gt;&gt;&gt; kappa = kappa0 + (kappa1 + kappa2*(kappa3-Tr)*(1-sqrt(Tr)))*(1+sqrt(Tr))*(Rational(&#39;0.7&#39;)-Tr)</span>
<span class="sd">        &gt;&gt;&gt; a_alpha = a*(1 + kappa*(1-sqrt(T/Tc)))**2</span>
<span class="sd">        &gt;&gt;&gt; # diff(a_alpha, T)</span>
<span class="sd">        &gt;&gt;&gt; # diff(a_alpha, T, 2)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">kappa0</span><span class="p">,</span> <span class="n">kappa1</span><span class="p">,</span> <span class="n">kappa2</span><span class="p">,</span> <span class="n">kappa3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa3</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
            <span class="n">kappa</span> <span class="o">=</span> <span class="n">kappa0</span> <span class="o">+</span> <span class="p">((</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="n">kappa3</span> <span class="o">-</span> <span class="n">Tr</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Tr</span><span class="o">**</span><span class="mf">0.5</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">Tr</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.7</span> <span class="o">-</span> <span class="n">Tr</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x4</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="mf">1.</span>
                <span class="n">x5</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">*</span><span class="n">x1</span> <span class="o">-</span> <span class="mf">7.</span>
                <span class="n">x6</span> <span class="o">=</span> <span class="o">-</span><span class="n">kappa3</span> <span class="o">+</span> <span class="n">x1</span>
                <span class="n">x7</span> <span class="o">=</span> <span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x6</span>
                <span class="n">x8</span> <span class="o">=</span> <span class="n">x5</span><span class="o">*</span><span class="n">x7</span>
                <span class="n">x9</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">*</span><span class="n">kappa0</span> <span class="o">-</span> <span class="n">x4</span><span class="o">*</span><span class="n">x8</span>
                <span class="n">x10</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="n">x9</span>
                <span class="n">x11</span> <span class="o">=</span> <span class="n">x10</span><span class="o">*</span><span class="mf">0.1</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x13</span> <span class="o">=</span> <span class="n">x2</span><span class="o">/</span><span class="n">T</span>
                <span class="n">x14</span> <span class="o">=</span> <span class="n">x7</span><span class="o">/</span><span class="n">Tc</span>
                <span class="n">x15</span> <span class="o">=</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">x4</span><span class="o">*</span><span class="n">x5</span>
                <span class="n">x16</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x2</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">x13</span><span class="o">*</span><span class="p">(</span><span class="n">kappa3</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
                <span class="n">x17</span> <span class="o">=</span> <span class="o">-</span><span class="n">x13</span><span class="o">*</span><span class="n">x8</span> <span class="o">-</span> <span class="n">x14</span><span class="o">*</span><span class="p">(</span><span class="mf">20.</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="mf">20.</span><span class="p">)</span> <span class="o">+</span> <span class="n">x15</span><span class="o">*</span><span class="n">x16</span>
                <span class="n">x18</span> <span class="o">=</span> <span class="n">x13</span><span class="o">*</span><span class="n">x9</span> <span class="o">+</span> <span class="n">x17</span><span class="o">*</span><span class="n">x3</span>
                <span class="n">x19</span> <span class="o">=</span> <span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
                <span class="n">x20</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="n">T</span>
                
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x11</span><span class="o">*</span><span class="n">x11</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x11</span><span class="o">*</span><span class="n">x18</span><span class="o">*</span><span class="mf">0.1</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x18</span><span class="o">*</span><span class="n">x18</span> <span class="o">+</span> <span class="p">(</span><span class="n">x10</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x17</span><span class="o">*</span><span class="n">x20</span> <span class="o">-</span> <span class="n">x19</span><span class="o">*</span><span class="n">x9</span> <span class="o">+</span> <span class="n">x3</span><span class="o">*</span><span class="p">(</span><span class="mf">40.</span><span class="o">*</span><span class="n">kappa2</span><span class="o">/</span><span class="n">Tc</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x4</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x20</span><span class="o">*</span><span class="n">x5</span> <span class="o">-</span> <span class="mf">40.</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">x14</span><span class="o">*</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x15</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="p">(</span><span class="mf">4.</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">x6</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="n">x19</span><span class="o">*</span><span class="n">x8</span><span class="p">)))</span><span class="o">/</span><span class="mf">200.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">kappa</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">-</span> <span class="n">kappa2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">kappa0</span> <span class="o">+</span> <span class="p">(</span><span class="n">kappa1</span> <span class="o">+</span> <span class="n">kappa2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="n">kappa3</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span> <span class="o">+</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div></div>


<div class="viewcode-block" id="VDW"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.VDW">[docs]</a><span class="k">class</span> <span class="nc">VDW</span><span class="p">(</span><span class="n">GCEOS</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Van der Waals cubic </span>
<span class="sd">    equation of state for a pure compound. Subclasses `CUBIC_EOS`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which sets </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`. `main_derivatives_and_departures` is</span>
<span class="sd">    a re-implementation with VDW specific methods, as the general solution</span>
<span class="sd">    has ZeroDivisionError errors.</span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P=\frac{RT}{V-b}-\frac{a}{V^2}</span>
<span class="sd">        </span>
<span class="sd">        a=\frac{27}{64}\frac{(RT_c)^2}{P_c}</span>

<span class="sd">        b=\frac{RT_c}{8P_c}</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------    </span>
<span class="sd">    &gt;&gt;&gt; eos = VDW(Tc=507.6, Pc=3025000, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.00022332978038490077, -13385.722837649315, -32.65922018109096)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `omega` is allowed as an input for compatibility with the other EOS forms,</span>
<span class="sd">    but is not used.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Poling, Bruce E. The Properties of Gases and Liquids. 5th </span>
<span class="sd">       edition. New York: McGraw-Hill Professional, 2000.</span>
<span class="sd">    .. [2] Walas, Stanley M. Phase Equilibria in Chemical Engineering. </span>
<span class="sd">       Butterworth-Heinemann, 1985.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">Zc</span> <span class="o">=</span> <span class="mi">3</span><span class="o">/</span><span class="mf">8.</span>

    <span class="c1"># Coefficients personally regressed, and tested against published solutions</span>
    <span class="c1"># fit with polyfit; 10th order found to be suitable and gains afterward are</span>
    <span class="c1"># tiny or negative</span>
    <span class="n">Psat_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.00016085874036294383</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0020147694986371641</span><span class="p">,</span> 
                   <span class="mf">0.011302214511559567</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.037903025677446814</span><span class="p">,</span> 
                   <span class="mf">0.086735406241856494</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15182421588718523</span><span class="p">,</span> 
                   <span class="mf">0.23310737420980204</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32912533484896433</span><span class="p">,</span> 
                   <span class="mf">0.29955810023815194</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9999750707517197</span><span class="p">,</span> 
                   <span class="o">-</span><span class="mf">3.6235991987648481e-07</span><span class="p">]</span>
    <span class="n">Psat_coeffs_limiting</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.0232164484175756</span><span class="p">,</span> <span class="mf">0.20980668241160666</span><span class="p">]</span>
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">27.0</span><span class="o">/</span><span class="mf">64.0</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="p">(</span><span class="mf">8.</span><span class="o">*</span><span class="n">Pc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="VDW.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.VDW.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `a`.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            a\alpha = a</span>
<span class="sd">        </span>
<span class="sd">            \frac{d a\alpha}{dT} = 0</span>

<span class="sd">            \frac{d^2 a\alpha}{dT^2} = 0</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="VDW.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.VDW.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the VDW</span>
<span class="sd">        EOS. Uses `a`, and `b`, obtained from the class&#39;s namespace.</span>

<span class="sd">        .. math::</span>
<span class="sd">            T =  \frac{1}{R V^{2}} \left(P V^{2} \left(V - b\right)</span>
<span class="sd">            + V a - a b\right)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="VDW.main_derivatives_and_departures"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.VDW.main_derivatives_and_departures">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">main_derivatives_and_departures</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">a_alpha</span><span class="p">,</span>
                                        <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Re-implementation of derivatives and excess property calculations, </span>
<span class="sd">        as ZeroDivisionError errors occur with the general solution. The </span>
<span class="sd">        following derivation is the source of these formulas.</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V, R, b, a = symbols(&#39;P, T, V, R, b, a&#39;)</span>
<span class="sd">        &gt;&gt;&gt; P_vdw = R*T/(V-b) - a/(V*V)</span>
<span class="sd">        &gt;&gt;&gt; vdw = P_vdw - P</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; dP_dT = diff(vdw, T)</span>
<span class="sd">        &gt;&gt;&gt; dP_dV = diff(vdw, V)</span>
<span class="sd">        &gt;&gt;&gt; d2P_dT2 = diff(vdw, T, 2)</span>
<span class="sd">        &gt;&gt;&gt; d2P_dV2 = diff(vdw, V, 2)</span>
<span class="sd">        &gt;&gt;&gt; d2P_dTdV = diff(vdw, T, V)</span>
<span class="sd">        &gt;&gt;&gt; H_dep = integrate(T*dP_dT - P_vdw, (V, oo, V))</span>
<span class="sd">        &gt;&gt;&gt; H_dep += P*V - R*T</span>
<span class="sd">        &gt;&gt;&gt; S_dep = integrate(dP_dT - R/V, (V,oo,V))</span>
<span class="sd">        &gt;&gt;&gt; S_dep += R*log(P*V/(R*T))</span>
<span class="sd">        &gt;&gt;&gt; Cv_dep = T*integrate(d2P_dT2, (V,oo,V))</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; dP_dT, dP_dV, d2P_dT2, d2P_dV2, d2P_dTdV, H_dep, S_dep, Cv_dep</span>
<span class="sd">        (R/(V - b), -R*T/(V - b)**2 + 2*a/V**3, 0, 2*(R*T/(V - b)**3 - 3*a/V**4), -R/(V - b)**2, P*V - R*T - a/V, R*(-log(V) + log(V - b)) + R*log(P*V/(R*T)), 0)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dP_dT</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">dP_dV</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a_alpha</span><span class="o">/</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span>
        <span class="n">d2P_dT2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">d2P_dV2</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">a_alpha</span><span class="o">/</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">d2P_dTdV</span> <span class="o">=</span> <span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">H_dep</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span> <span class="o">-</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span> <span class="o">-</span> <span class="n">a_alpha</span><span class="o">/</span><span class="n">V</span>
        <span class="n">S_dep</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">log</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="p">))</span>
        <span class="n">Cv_dep</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">dP_dT</span><span class="p">,</span> <span class="n">dP_dV</span><span class="p">,</span> <span class="n">d2P_dT2</span><span class="p">,</span> <span class="n">d2P_dV2</span><span class="p">,</span> <span class="n">d2P_dTdV</span><span class="p">,</span> <span class="n">H_dep</span><span class="p">,</span> <span class="n">S_dep</span><span class="p">,</span> <span class="n">Cv_dep</span><span class="p">]</span></div></div>

        

<div class="viewcode-block" id="RK"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.RK">[docs]</a><span class="k">class</span> <span class="nc">RK</span><span class="p">(</span><span class="n">GCEOS</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Redlich-Kwong cubic </span>
<span class="sd">    equation of state for a pure compound. Subclasses `CUBIC_EOS`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which sets </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`. </span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P =\frac{RT}{V-b}-\frac{a}{V\sqrt{T}(V+b)}</span>
<span class="sd">        </span>
<span class="sd">        a=\left(\frac{R^2(T_c)^{2.5}}{9(\sqrt[3]{2}-1)P_c} \right)</span>
<span class="sd">        =\frac{0.42748\cdot R^2(T_c)^{2.5}}{P_c}</span>
<span class="sd">        </span>
<span class="sd">        b=\left( \frac{(\sqrt[3]{2}-1)}{3}\right)\frac{RT_c}{P_c}</span>
<span class="sd">        =\frac{0.08664\cdot R T_c}{P_c}</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------    </span>
<span class="sd">    &gt;&gt;&gt; eos = RK(Tc=507.6, Pc=3025000, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.00015189341729751862, -26160.833620674086, -63.01311649400544)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    `omega` is allowed as an input for compatibility with the other EOS forms,</span>
<span class="sd">    but is not used.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Redlich, Otto., and J. N. S. Kwong. &quot;On the Thermodynamics of </span>
<span class="sd">       Solutions. V. An Equation of State. Fugacities of Gaseous Solutions.&quot; </span>
<span class="sd">       Chemical Reviews 44, no. 1 (February 1, 1949): 233-44. </span>
<span class="sd">       doi:10.1021/cr60137a013.</span>
<span class="sd">    .. [2] Poling, Bruce E. The Properties of Gases and Liquids. 5th </span>
<span class="sd">       edition. New York: McGraw-Hill Professional, 2000.</span>
<span class="sd">    .. [3] Walas, Stanley M. Phase Equilibria in Chemical Engineering. </span>
<span class="sd">       Butterworth-Heinemann, 1985.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.4274802335403414043909906940611707345513</span> <span class="c1"># 1/(9*(2**(1/3.)-1)) </span>
    <span class="n">c2</span> <span class="o">=</span> <span class="mf">0.08664034996495772158907020242607611685675</span> <span class="c1"># (2**(1/3.)-1)/3 </span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">omega</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">Zc</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.</span>

    <span class="c1"># Coefficients personally regressed, and tested against published solutions</span>
    <span class="c1"># fit with polyfit; 10th order found to be suitable and gains afterward are</span>
    <span class="c1"># tiny or negative</span>
    <span class="n">Psat_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">704544.24412816577</span><span class="p">,</span> <span class="mf">3561602.0999577316</span><span class="p">,</span> <span class="mf">6656106.8246219782</span><span class="p">,</span> 
                   <span class="mf">4335693.4538969155</span><span class="p">,</span> <span class="o">-</span><span class="mf">2349194.3033746872</span><span class="p">,</span> 
                   <span class="o">-</span><span class="mf">4335442.8251242582</span><span class="p">,</span> <span class="mf">326862.94121967856</span><span class="p">,</span> <span class="mf">4024294.3438453656</span><span class="p">,</span>
                   <span class="mf">3188268.8928488772</span><span class="p">,</span> <span class="mf">1083057.9018650202</span><span class="p">,</span> <span class="mf">142620.21200653521</span><span class="p">]</span>
    <span class="n">Psat_coeffs_limiting</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">72.700288369511583</span><span class="p">,</span> <span class="o">-</span><span class="mf">68.76714163049</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mf">2.5</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="RK.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.RK.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `a`.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            a\alpha = \frac{a}{\sqrt{T}}</span>
<span class="sd">        </span>
<span class="sd">            \frac{d a\alpha}{dT} = - \frac{a}{2 T^{\frac{3}{2}}}</span>

<span class="sd">            \frac{d^2 a\alpha}{dT^2} = \frac{3 a}{4 T^{\frac{5}{2}}}</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">T</span><span class="o">**-</span><span class="mf">0.5</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="mf">0.75</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="RK.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.RK.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the RK</span>
<span class="sd">        EOS. Uses `a`, and `b`, obtained from the class&#39;s namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The exact solution can be derived as follows; it is excluded for </span>
<span class="sd">        breviety.</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V, R = symbols(&#39;P, T, V, R&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tc, Pc = symbols(&#39;Tc, Pc&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a, b = symbols(&#39;a, b&#39;)</span>

<span class="sd">        &gt;&gt;&gt; RK = Eq(P, R*T/(V-b) - a/sqrt(T)/(V*V + b*V))</span>
<span class="sd">        &gt;&gt;&gt; # solve(RK, T)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="n">j</span><span class="o">*</span><span class="mf">1.7320508075688772</span> <span class="o">+</span> <span class="mf">1.</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">b</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">x2</span><span class="o">/</span><span class="n">R</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="n">b</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.7320508075688772</span><span class="o">*</span><span class="p">(</span><span class="n">x2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">x3</span> <span class="o">+</span> <span class="mf">27.</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">x4</span><span class="o">*</span><span class="n">x4</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">-</span> <span class="mf">9.</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="n">x4</span><span class="p">)</span> <span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="mf">3.3019272488946263</span><span class="o">*</span><span class="p">(</span><span class="mf">11.537996562459266</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.2599210498948732</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mf">144.0</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">729</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">V</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">108</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">V</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="p">))</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">729</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">V</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">108</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">V</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">R</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">V</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="p">))</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">real</span></div></div>


<div class="viewcode-block" id="SRK"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.SRK">[docs]</a><span class="k">class</span> <span class="nc">SRK</span><span class="p">(</span><span class="n">GCEOS</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Soave-Redlich-Kwong cubic </span>
<span class="sd">    equation of state for a pure compound. Subclasses `CUBIC_EOS`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which sets </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`. </span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{V-b} - \frac{a\alpha(T)}{V(V+b)}</span>
<span class="sd">        </span>
<span class="sd">        a=\left(\frac{R^2(T_c)^{2}}{9(\sqrt[3]{2}-1)P_c} \right)</span>
<span class="sd">        =\frac{0.42748\cdot R^2(T_c)^{2}}{P_c}</span>
<span class="sd">    </span>
<span class="sd">        b=\left( \frac{(\sqrt[3]{2}-1)}{3}\right)\frac{RT_c}{P_c}</span>
<span class="sd">        =\frac{0.08664\cdot R T_c}{P_c}</span>
<span class="sd">        </span>
<span class="sd">        \alpha(T) = \left[1 + m\left(1 - \sqrt{\frac{T}{T_c}}\right)\right]^2</span>
<span class="sd">        </span>
<span class="sd">        m = 0.480 + 1.574\omega - 0.176\omega^2</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------    </span>
<span class="sd">    &gt;&gt;&gt; eos = SRK(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.00014682102759032003, -31754.65309653571, -74.3732468359525)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Soave, Giorgio. &quot;Equilibrium Constants from a Modified Redlich-Kwong</span>
<span class="sd">       Equation of State.&quot; Chemical Engineering Science 27, no. 6 (June 1972): </span>
<span class="sd">       1197-1203. doi:10.1016/0009-2509(72)80096-4.</span>
<span class="sd">    .. [2] Poling, Bruce E. The Properties of Gases and Liquids. 5th </span>
<span class="sd">       edition. New York: McGraw-Hill Professional, 2000.</span>
<span class="sd">    .. [3] Walas, Stanley M. Phase Equilibria in Chemical Engineering. </span>
<span class="sd">       Butterworth-Heinemann, 1985.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.4274802335403414043909906940611707345513</span> <span class="c1"># 1/(9*(2**(1/3.)-1)) </span>
    <span class="n">c2</span> <span class="o">=</span> <span class="mf">0.08664034996495772158907020242607611685675</span> <span class="c1"># (2**(1/3.)-1)/3 </span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Zc</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.</span>

    <span class="c1"># Coefficients personally regressed, and tested against published solutions</span>
    <span class="c1"># fit with polyfit; 10th order found to be suitable and gains afterward are</span>
    <span class="c1"># tiny or negative</span>
    <span class="n">Psat_coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.2606704044732426e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.4948284125616183e-05</span><span class="p">,</span> 
                   <span class="mf">0.00096619488646838912</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0063685162795048839</span><span class="p">,</span> 
                   <span class="mf">0.027478137804348456</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.084187977198985922</span><span class="p">,</span> 
                   <span class="mf">0.19421926832038514</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.33318228306947267</span><span class="p">,</span> 
                   <span class="mf">0.32096274163660671</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.0522790305186756</span><span class="p">,</span> 
                   <span class="o">-</span><span class="mf">3.6895279306603668e-05</span><span class="p">]</span>
    <span class="n">Psat_coeffs_limiting</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.2308843103522107</span><span class="p">,</span> <span class="mf">0.7210534170705403</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="mf">0.480</span> <span class="o">+</span> <span class="mf">1.574</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.176</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="SRK.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.SRK.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `m`, and `a`.</span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            a\alpha = a \left(m \left(- \sqrt{\frac{T}{Tc}} + 1\right)</span>
<span class="sd">            + 1\right)^{2}</span>
<span class="sd">        </span>
<span class="sd">            \frac{d a\alpha}{dT} = \frac{a m}{T} \sqrt{\frac{T}{Tc}} \left(m</span>
<span class="sd">            \left(\sqrt{\frac{T}{Tc}} - 1\right) - 1\right)</span>

<span class="sd">            \frac{d^2 a\alpha}{dT^2} = \frac{a m \sqrt{\frac{T}{Tc}}}{2 T^{2}}</span>
<span class="sd">            \left(m + 1\right)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
        <span class="n">sqTr</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">sqTr</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a_alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">sqTr</span><span class="o">*</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqTr</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">T</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span>  <span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">sqTr</span><span class="o">*</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="SRK.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.SRK.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the SRK</span>
<span class="sd">        EOS. Uses `a`, `b`, and `Tc` obtained from the class&#39;s namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The exact solution can be derived as follows; it is excluded for </span>
<span class="sd">        breviety.</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; from sympy import *</span>
<span class="sd">        &gt;&gt;&gt; P, T, V, R, a, b, m = symbols(&#39;P, T, V, R, a, b, m&#39;)</span>
<span class="sd">        &gt;&gt;&gt; Tc, Pc, omega = symbols(&#39;Tc, Pc, omega&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a_alpha = a*(1 + m*(1-sqrt(T/Tc)))**2</span>
<span class="sd">        &gt;&gt;&gt; SRK = R*T/(V-b) - a_alpha/(V*(V+b)) - P</span>
<span class="sd">        &gt;&gt;&gt; # solve(SRK, T)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">V</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">x0</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">m</span>
            <span class="n">x6</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x5</span>
            <span class="n">x7</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x8</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x9</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">x4</span> <span class="o">+</span> <span class="n">x7</span> <span class="o">-</span> <span class="n">x8</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">x10</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x11</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span>
            <span class="n">x12</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span>
            <span class="n">x13</span> <span class="o">=</span> <span class="n">x5</span><span class="o">*</span><span class="n">x5</span>
            <span class="n">x14</span> <span class="o">=</span> <span class="n">x12</span><span class="o">*</span><span class="n">x13</span>
            <span class="n">x15</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">b</span>
            <span class="n">x16</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="n">V</span>
            <span class="n">x17</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x0</span>
            <span class="n">x18</span> <span class="o">=</span> <span class="n">x17</span><span class="o">*</span><span class="n">x5</span>
            <span class="n">x19</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">x16</span>
            <span class="n">x20</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">x14</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">x15</span><span class="o">*</span><span class="n">x18</span> <span class="o">+</span> <span class="n">x10</span><span class="o">*</span><span class="n">x11</span> <span class="o">+</span> <span class="n">x11</span><span class="o">*</span><span class="n">x15</span><span class="o">*</span><span class="n">x3</span> <span class="o">+</span> <span class="n">x11</span><span class="o">*</span><span class="n">x19</span> <span class="o">+</span> <span class="n">x14</span><span class="o">*</span><span class="n">x15</span> <span class="o">+</span> <span class="n">x14</span><span class="o">*</span><span class="n">x3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x18</span>
            <span class="n">x21</span> <span class="o">=</span> <span class="n">V</span> <span class="o">-</span> <span class="n">b</span>
            <span class="n">x22</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">x17</span>
            <span class="n">x23</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">x4</span>
            <span class="n">x24</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">x8</span>
            <span class="n">x25</span> <span class="o">=</span> <span class="n">x1</span><span class="o">*</span><span class="n">x17</span>
            <span class="n">x26</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span>
            <span class="n">x27</span> <span class="o">=</span> <span class="n">x17</span><span class="o">*</span><span class="n">x3</span>
            <span class="n">x28</span> <span class="o">=</span> <span class="n">V</span><span class="o">*</span><span class="n">x12</span>
            <span class="n">x29</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">m</span>
            <span class="n">x30</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">x12</span>
            <span class="k">return</span> <span class="o">-</span><span class="n">Tc</span><span class="o">*</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">x9</span><span class="o">*</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="n">x21</span><span class="o">*</span><span class="n">x21</span><span class="o">*</span><span class="n">x21</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">x2</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">x7</span> <span class="o">+</span> <span class="n">x17</span> <span class="o">+</span> <span class="n">x18</span> <span class="o">+</span> <span class="n">x22</span> <span class="o">+</span> <span class="n">x23</span> <span class="o">-</span> <span class="n">x24</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="n">x20</span><span class="o">*</span><span class="n">x21</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">P</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x6</span> <span class="o">+</span> <span class="n">x1</span><span class="o">*</span><span class="n">x22</span> <span class="o">+</span> <span class="n">x10</span><span class="o">*</span><span class="n">x26</span> <span class="o">+</span> <span class="n">x13</span><span class="o">*</span><span class="n">x28</span> <span class="o">-</span> <span class="n">x13</span><span class="o">*</span><span class="n">x30</span> <span class="o">+</span> <span class="n">x15</span><span class="o">*</span><span class="n">x23</span> <span class="o">+</span> <span class="n">x15</span><span class="o">*</span><span class="n">x24</span> <span class="o">+</span> <span class="n">x19</span><span class="o">*</span><span class="n">x26</span> <span class="o">+</span> <span class="n">x22</span><span class="o">*</span><span class="n">x3</span> <span class="o">+</span> <span class="n">x25</span><span class="o">*</span><span class="n">x5</span> <span class="o">+</span> <span class="n">x25</span> <span class="o">+</span> <span class="n">x27</span><span class="o">*</span><span class="n">x5</span> <span class="o">+</span> <span class="n">x27</span> <span class="o">+</span> <span class="n">x28</span><span class="o">*</span><span class="n">x29</span> <span class="o">+</span> <span class="n">x28</span><span class="o">*</span><span class="n">x5</span> <span class="o">-</span> <span class="n">x29</span><span class="o">*</span><span class="n">x30</span> <span class="o">-</span> <span class="n">x30</span><span class="o">*</span><span class="n">x5</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x20</span><span class="o">*</span><span class="n">x9</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Tc</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">a</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">P</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">((</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">R</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">Tc</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">V</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="APISRK"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.APISRK">[docs]</a><span class="k">class</span> <span class="nc">APISRK</span><span class="p">(</span><span class="n">SRK</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Refinery Soave-Redlich-Kwong cubic </span>
<span class="sd">    equation of state for a pure compound shown in the API Databook [1]_.</span>
<span class="sd">    Subclasses `CUBIC_EOS`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which sets </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`. Two fit constants are used in this </span>
<span class="sd">    expresion, with an estimation scheme for the first if unavailable and the</span>
<span class="sd">    second may be set to zero.</span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{V-b} - \frac{a\alpha(T)}{V(V+b)}</span>
<span class="sd">        </span>
<span class="sd">        a=\left(\frac{R^2(T_c)^{2}}{9(\sqrt[3]{2}-1)P_c} \right)</span>
<span class="sd">        =\frac{0.42748\cdot R^2(T_c)^{2}}{P_c}</span>
<span class="sd">    </span>
<span class="sd">        b=\left( \frac{(\sqrt[3]{2}-1)}{3}\right)\frac{RT_c}{P_c}</span>
<span class="sd">        =\frac{0.08664\cdot R T_c}{P_c}</span>
<span class="sd">        </span>
<span class="sd">        \alpha(T) = \left[1 + S_1\left(1-\sqrt{T_r}\right) + S_2\frac{1</span>
<span class="sd">        - \sqrt{T_r}}{\sqrt{T_r}}\right]^2</span>
<span class="sd">        </span>
<span class="sd">        S_1 = 0.48508 + 1.55171\omega - 0.15613\omega^2 \text{ if S1 is not tabulated }</span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float, optional</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>
<span class="sd">    S1 : float, optional</span>
<span class="sd">        Fit constant or estimated from acentric factor if not provided [-]</span>
<span class="sd">    S2 : float, optional</span>
<span class="sd">        Fit constant or 0 if not provided [-]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------    </span>
<span class="sd">    &gt;&gt;&gt; eos = APISRK(Tc=514.0, Pc=6137000.0, S1=1.678665, S2=-0.216396, P=1E6, T=299)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 7.045692682173235e-05, -42826.271630638774, -103.62694391379836)</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] API Technical Data Book: General Properties &amp; Characterization.</span>
<span class="sd">       American Petroleum Institute, 7E, 2005.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">S2</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S1&#39;</span><span class="p">:</span> <span class="n">S1</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">:</span> <span class="n">S2</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_sufficient_inputs</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">S1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">omega</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Either acentric factor of S1 is required&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">S1</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S1</span> <span class="o">=</span> <span class="mf">0.48508</span> <span class="o">+</span> <span class="mf">1.55171</span><span class="o">*</span><span class="n">omega</span> <span class="o">-</span> <span class="mf">0.15613</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">omega</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">S1</span> <span class="o">=</span> <span class="n">S1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">S2</span> <span class="o">=</span> <span class="n">S2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="APISRK.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.APISRK.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `a`, `S1`, and `S2`. </span>
<span class="sd">        </span>
<span class="sd">        .. math::</span>
<span class="sd">            a\alpha(T) = a\left[1 + S_1\left(1-\sqrt{T_r}\right) + S_2\frac{1</span>
<span class="sd">            - \sqrt{T_r}}{\sqrt{T_r}}\right]^2</span>
<span class="sd">        </span>
<span class="sd">            \frac{d a\alpha}{dT} = a\frac{Tc}{T^{2}} \left(- S_{2} \left(\sqrt{</span>
<span class="sd">            \frac{T}{Tc}} - 1\right) + \sqrt{\frac{T}{Tc}} \left(S_{1} \sqrt{</span>
<span class="sd">            \frac{T}{Tc}} + S_{2}\right)\right) \left(S_{2} \left(\sqrt{\frac{</span>
<span class="sd">            T}{Tc}} - 1\right) + \sqrt{\frac{T}{Tc}} \left(S_{1} \left(\sqrt{</span>
<span class="sd">            \frac{T}{Tc}} - 1\right) - 1\right)\right)</span>

<span class="sd">            \frac{d^2 a\alpha}{dT^2} = a\frac{1}{2 T^{3}} \left(S_{1}^{2} T</span>
<span class="sd">            \sqrt{\frac{T}{Tc}} - S_{1} S_{2} T \sqrt{\frac{T}{Tc}} + 3 S_{1}</span>
<span class="sd">            S_{2} Tc \sqrt{\frac{T}{Tc}} + S_{1} T \sqrt{\frac{T}{Tc}} </span>
<span class="sd">            - 3 S_{2}^{2} Tc \sqrt{\frac{T}{Tc}} + 4 S_{2}^{2} Tc + 3 S_{2} </span>
<span class="sd">            Tc \sqrt{\frac{T}{Tc}}\right)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S2</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">/</span><span class="n">x0</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="n">S2</span><span class="o">*</span><span class="n">x2</span>
                <span class="n">x4</span> <span class="o">=</span> <span class="n">S1</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">-</span> <span class="mf">1.</span>
                <span class="n">x5</span> <span class="o">=</span> <span class="n">S1</span><span class="o">*</span><span class="n">x0</span>
                <span class="n">x6</span> <span class="o">=</span> <span class="n">S2</span> <span class="o">-</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x5</span>
                <span class="n">x7</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">S2</span>
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x4</span><span class="o">*</span><span class="n">x4</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">x4</span><span class="o">*</span><span class="n">x6</span><span class="o">/</span><span class="n">T</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x4</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x2</span><span class="o">*</span><span class="n">x7</span> <span class="o">+</span> <span class="n">x5</span> <span class="o">+</span> <span class="n">x7</span><span class="p">)</span> <span class="o">+</span> <span class="n">x6</span><span class="o">*</span><span class="n">x6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="n">T</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">S1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">S1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">S2</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">))))</span>
                <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(((</span><span class="n">S1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="n">S2</span> <span class="o">-</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">S2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span></div>

<div class="viewcode-block" id="APISRK.solve_T"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.APISRK.solve_T">[docs]</a>    <span class="k">def</span> <span class="nf">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `T` from a specified `P` and `V` for the API </span>
<span class="sd">        SRK EOS. Uses `a`, `b`, and `Tc` obtained from the class&#39;s namespace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure, [Pa]</span>
<span class="sd">        V : float</span>
<span class="sd">            Molar volume, [m^3/mol]</span>
<span class="sd">        quick : bool, optional</span>
<span class="sd">            Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">            individual formulas</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature, [K]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If S2 is set to 0, the solution is the same as in the SRK EOS, and that</span>
<span class="sd">        is used. Otherwise, newton&#39;s method must be used to solve for `T`. </span>
<span class="sd">        There are 8 roots of T in that case, six of them real. No guarantee can</span>
<span class="sd">        be made regarding which root will be obtained.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">S2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1</span>
            <span class="k">return</span> <span class="n">SRK</span><span class="o">.</span><span class="n">solve_T</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="n">quick</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Previously coded method is  63 microseconds vs 47 here</span>
<span class="c1">#            return super(SRK, self).solve_T(P, V, quick=quick) </span>
            <span class="n">Tc</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">S1</span><span class="p">,</span> <span class="n">S2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">S2</span>
            <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
                <span class="n">x2</span> <span class="o">=</span> <span class="n">R</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>
                <span class="n">x3</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
                <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
                    <span class="n">x0</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                    <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="mf">1.</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">x2</span><span class="o">*</span><span class="n">T</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="n">x1</span> <span class="o">+</span> <span class="n">S2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="n">x0</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">x3</span><span class="p">)</span> <span class="o">-</span> <span class="n">P</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">def</span> <span class="nf">to_solve</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
                    <span class="n">P_calc</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">S1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">S2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">V</span><span class="o">*</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
                    <span class="k">return</span> <span class="n">P_calc</span> <span class="o">-</span> <span class="n">P</span>
            <span class="k">return</span> <span class="n">newton</span><span class="p">(</span><span class="n">to_solve</span><span class="p">,</span> <span class="n">Tc</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TWUPR"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.TWUPR">[docs]</a><span class="k">class</span> <span class="nc">TWUPR</span><span class="p">(</span><span class="n">PR</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Twu [1]_ variant of the Peng-Robinson cubic </span>
<span class="sd">    equation of state for a pure compound. Subclasses `PR`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which sets </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`. </span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{v-b}-\frac{a\alpha(T)}{v(v+b)+b(v-b)}</span>

<span class="sd">        a=0.45724\frac{R^2T_c^2}{P_c}</span>
<span class="sd">        </span>
<span class="sd">	  b=0.07780\frac{RT_c}{P_c}</span>
<span class="sd">   </span>
<span class="sd">       \alpha = \alpha^{(0)} + \omega(\alpha^{(1)}-\alpha^{(0)})</span>
<span class="sd">       </span>
<span class="sd">       \alpha^{(i)} = T_r^{N(M-1)}\exp[L(1-T_r^{NM})]</span>
<span class="sd">      </span>
<span class="sd">    For sub-critical conditions:</span>
<span class="sd">    </span>
<span class="sd">    L0, M0, N0 =  0.125283, 0.911807,  1.948150;</span>
<span class="sd">    </span>
<span class="sd">    L1, M1, N1 = 0.511614, 0.784054, 2.812520</span>
<span class="sd">    </span>
<span class="sd">    For supercritical conditions:</span>
<span class="sd">    </span>
<span class="sd">    L0, M0, N0 = 0.401219, 4.963070, -0.2;</span>
<span class="sd">    </span>
<span class="sd">    L1, M1, N1 = 0.024955, 1.248089, -8.  </span>
<span class="sd">        </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; eos = TWUPR(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (0.0001301754975832378, -31652.72639160809, -74.11282530917981)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Claimed to be more accurate than the PR, PR78 and PRSV equations.</span>

<span class="sd">    There is no analytical solution for `T`. There are multiple possible </span>
<span class="sd">    solutions for `T` under certain conditions; no guaranteed are provided</span>
<span class="sd">    regarding which solution is obtained.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Twu, Chorng H., John E. Coon, and John R. Cunningham. &quot;A New </span>
<span class="sd">       Generalized Alpha Function for a Cubic Equation of State Part 1. </span>
<span class="sd">       Peng-Robinson Equation.&quot; Fluid Phase Equilibria 105, no. 1 (March 15, </span>
<span class="sd">       1995): 49-59. doi:10.1016/0378-3812(94)02601-V.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_sufficient_inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">solve_T</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PR</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">solve_T</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<div class="viewcode-block" id="TWUPR.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.TWUPR.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `omega`, and `a`.</span>
<span class="sd">        </span>
<span class="sd">        Because of its similarity for the TWUSRK EOS, this has been moved to an </span>
<span class="sd">        external `TWU_a_alpha_common` function. See it for further </span>
<span class="sd">        documentation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">TWU_a_alpha_common</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="n">quick</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;PR&#39;</span><span class="p">)</span></div></div>


<span class="k">def</span> <span class="nf">TWU_a_alpha_common</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;PR&#39;</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Function to calculate `a_alpha` and optionally its first and second</span>
<span class="sd">    derivatives for the TWUPR or TWUSRK EOS. Returns &#39;a_alpha&#39;, and </span>
<span class="sd">    optionally &#39;da_alpha_dT&#39; and &#39;d2a_alpha_dT2&#39;.</span>
<span class="sd">    Used by `TWUPR` and `TWUSRK`; has little purpose on its own.</span>
<span class="sd">    See either class for the correct reference, and examples of using the EOS.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    T : float</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    a : float</span>
<span class="sd">        Coefficient calculated by EOS-specific method, [J^2/mol^2/Pa]</span>
<span class="sd">    full : float</span>
<span class="sd">        Whether or not to return its first and second derivatives</span>
<span class="sd">    quick : bool, optional</span>
<span class="sd">        Whether to use a SymPy cse-derived expression (3x faster) or </span>
<span class="sd">        individual formulas</span>
<span class="sd">    method : str</span>
<span class="sd">        Either &#39;PR&#39; or &#39;SRK&#39;</span>
<span class="sd">        </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The derivatives are somewhat long and are not described here for </span>
<span class="sd">    brevity; they are obtainable from the following SymPy expression.</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; from sympy import *</span>
<span class="sd">    &gt;&gt;&gt; T, Tc, omega, N1, N0, M1, M0, L1, L0 = symbols(&#39;T, Tc, omega, N1, N0, M1, M0, L1, L0&#39;)</span>
<span class="sd">    &gt;&gt;&gt; Tr = T/Tc</span>
<span class="sd">    &gt;&gt;&gt; alpha0 = Tr**(N0*(M0-1))*exp(L0*(1-Tr**(N0*M0)))</span>
<span class="sd">    &gt;&gt;&gt; alpha1 = Tr**(N1*(M1-1))*exp(L1*(1-Tr**(N1*M1)))</span>
<span class="sd">    &gt;&gt;&gt; alpha = alpha0 + omega*(alpha1-alpha0)</span>
<span class="sd">    &gt;&gt;&gt; # diff(alpha, T)</span>
<span class="sd">    &gt;&gt;&gt; # diff(alpha, T, T)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;PR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Tr</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">L0</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="mf">0.125283</span><span class="p">,</span> <span class="mf">0.911807</span><span class="p">,</span> <span class="mf">1.948150</span>
            <span class="n">L1</span><span class="p">,</span> <span class="n">M1</span><span class="p">,</span> <span class="n">N1</span> <span class="o">=</span> <span class="mf">0.511614</span><span class="p">,</span> <span class="mf">0.784054</span><span class="p">,</span> <span class="mf">2.812520</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L0</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="mf">0.401219</span><span class="p">,</span> <span class="mf">4.963070</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span>
            <span class="n">L1</span><span class="p">,</span> <span class="n">M1</span><span class="p">,</span> <span class="n">N1</span> <span class="o">=</span> <span class="mf">0.024955</span><span class="p">,</span> <span class="mf">1.248089</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.</span>  
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;SRK&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Tr</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">L0</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="mf">0.141599</span><span class="p">,</span> <span class="mf">0.919422</span><span class="p">,</span> <span class="mf">2.496441</span>
            <span class="n">L1</span><span class="p">,</span> <span class="n">M1</span><span class="p">,</span> <span class="n">N1</span> <span class="o">=</span> <span class="mf">0.500315</span><span class="p">,</span> <span class="mf">0.799457</span><span class="p">,</span> <span class="mf">3.291790</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">L0</span><span class="p">,</span> <span class="n">M0</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="mf">0.441411</span><span class="p">,</span> <span class="mf">6.500018</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20</span>
            <span class="n">L1</span><span class="p">,</span> <span class="n">M1</span><span class="p">,</span> <span class="n">N1</span> <span class="o">=</span> <span class="mf">0.032580</span><span class="p">,</span>  <span class="mf">1.289098</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Only `PR` and `SRK` are accepted as method&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">full</span><span class="p">:</span>
        <span class="n">alpha0</span> <span class="o">=</span> <span class="n">Tr</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">Tr</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="n">M0</span><span class="p">)))</span>
        <span class="n">alpha1</span> <span class="o">=</span> <span class="n">Tr</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span><span class="o">-</span><span class="mf">1.</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L1</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">Tr</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="n">M1</span><span class="p">)))</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha0</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">alpha1</span> <span class="o">-</span> <span class="n">alpha0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">alpha</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">quick</span><span class="p">:</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="n">Tc</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">N0</span><span class="o">*</span><span class="n">x1</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="n">x0</span><span class="o">**</span><span class="n">x2</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">M0</span><span class="o">*</span><span class="n">N0</span>
            <span class="n">x5</span> <span class="o">=</span> <span class="n">x0</span><span class="o">**</span><span class="n">x4</span>
            <span class="n">x6</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="n">x5</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">))</span>
            <span class="n">x7</span> <span class="o">=</span> <span class="n">x3</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x8</span> <span class="o">=</span> <span class="n">M1</span> <span class="o">-</span> <span class="mf">1.</span>
            <span class="n">x9</span> <span class="o">=</span> <span class="n">N1</span><span class="o">*</span><span class="n">x8</span>
            <span class="n">x10</span> <span class="o">=</span> <span class="n">x0</span><span class="o">**</span><span class="n">x9</span>
            <span class="n">x11</span> <span class="o">=</span> <span class="n">M1</span><span class="o">*</span><span class="n">N1</span>
            <span class="n">x12</span> <span class="o">=</span> <span class="n">x0</span><span class="o">**</span><span class="n">x11</span>
            <span class="n">x13</span> <span class="o">=</span> <span class="n">x2</span><span class="o">*</span><span class="n">x7</span>
            <span class="n">x14</span> <span class="o">=</span> <span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x5</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x15</span> <span class="o">=</span> <span class="n">x13</span> <span class="o">-</span> <span class="n">x14</span>
            <span class="n">x16</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">(</span><span class="n">x12</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">x17</span> <span class="o">=</span> <span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="o">*</span><span class="n">x10</span><span class="o">*</span><span class="n">x12</span><span class="o">*</span><span class="n">x16</span> <span class="o">+</span> <span class="n">x10</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x9</span> <span class="o">-</span> <span class="n">x13</span> <span class="o">+</span> <span class="n">x14</span>
            <span class="n">x18</span> <span class="o">=</span> <span class="n">N0</span><span class="o">*</span><span class="n">N0</span>
            <span class="n">x19</span> <span class="o">=</span> <span class="n">x18</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x20</span> <span class="o">=</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x19</span>
            <span class="n">x21</span> <span class="o">=</span> <span class="n">M0</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">x22</span> <span class="o">=</span> <span class="n">L0</span><span class="o">*</span><span class="n">x18</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x5</span><span class="o">*</span><span class="n">x6</span>
            <span class="n">x23</span> <span class="o">=</span> <span class="n">x21</span><span class="o">*</span><span class="n">x22</span>
            <span class="n">x24</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x22</span>
            <span class="n">x25</span> <span class="o">=</span> <span class="n">L0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x0</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x4</span><span class="p">)</span><span class="o">*</span><span class="n">x19</span><span class="o">*</span><span class="n">x21</span>
            <span class="n">x26</span> <span class="o">=</span> <span class="n">N1</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">x27</span> <span class="o">=</span> <span class="n">x10</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x26</span>
            <span class="n">x28</span> <span class="o">=</span> <span class="n">M1</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">x29</span> <span class="o">=</span> <span class="n">L1</span><span class="o">*</span><span class="n">x10</span><span class="o">*</span><span class="n">x12</span><span class="o">*</span><span class="n">x16</span><span class="o">*</span><span class="n">x26</span>
            <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x10</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">x3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">+</span> <span class="n">x7</span><span class="p">)</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">x17</span> <span class="o">+</span> <span class="n">x15</span><span class="p">)</span><span class="o">/</span><span class="n">T</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x0</span><span class="o">**</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">x11</span><span class="p">)</span><span class="o">*</span><span class="n">x27</span><span class="o">*</span><span class="n">x28</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">M1</span><span class="o">*</span><span class="n">x29</span><span class="o">*</span><span class="n">x8</span> <span class="o">+</span> <span class="n">x17</span> <span class="o">+</span> <span class="n">x20</span> <span class="o">-</span> <span class="n">x23</span> <span class="o">-</span> <span class="n">x24</span> <span class="o">+</span> <span class="n">x25</span> <span class="o">-</span> <span class="n">x27</span><span class="o">*</span><span class="n">x8</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x28</span><span class="o">*</span><span class="n">x29</span><span class="p">)</span> <span class="o">+</span> <span class="n">x15</span> <span class="o">-</span> <span class="n">x20</span> <span class="o">+</span> <span class="n">x23</span> <span class="o">+</span> <span class="n">x24</span> <span class="o">-</span> <span class="n">x25</span><span class="p">)</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">a_alpha</span> <span class="o">=</span> <span class="n">TWU_a_alpha_common</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">Tc</span><span class="o">=</span><span class="n">Tc</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="n">quick</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
            <span class="n">da_alpha_dT</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">L1</span><span class="o">*</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">-</span> <span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L0</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span> <span class="o">+</span> <span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">L1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">T</span><span class="p">))</span>
            <span class="n">d2a_alpha_dT2</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">((</span><span class="n">L0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">M0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">omega</span><span class="o">*</span><span class="p">(</span><span class="n">L0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">M0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">L0</span><span class="o">*</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">L1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">M1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">N1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">L1</span><span class="o">*</span><span class="n">M1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">N1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">L1</span><span class="o">*</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">L1</span><span class="o">*</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">N0</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N0</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L0</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M0</span><span class="o">*</span><span class="n">N0</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">N1</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">N1</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">M1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="p">((</span><span class="n">T</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">M1</span><span class="o">*</span><span class="n">N1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))))</span><span class="o">/</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a_alpha</span><span class="p">,</span> <span class="n">da_alpha_dT</span><span class="p">,</span> <span class="n">d2a_alpha_dT2</span>


<div class="viewcode-block" id="TWUSRK"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.TWUSRK">[docs]</a><span class="k">class</span> <span class="nc">TWUSRK</span><span class="p">(</span><span class="n">SRK</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Class for solving the Soave-Redlich-Kwong cubic </span>
<span class="sd">    equation of state for a pure compound. Subclasses `CUBIC_EOS`, which </span>
<span class="sd">    provides the methods for solving the EOS and calculating its assorted </span>
<span class="sd">    relevant thermodynamic properties. Solves the EOS on initialization. </span>

<span class="sd">    Implemented methods here are `a_alpha_and_derivatives`, which sets </span>
<span class="sd">    a_alpha and its first and second derivatives, and `solve_T`, which from a </span>
<span class="sd">    specified `P` and `V` obtains `T`. </span>
<span class="sd">    </span>
<span class="sd">    Two of `T`, `P`, and `V` are needed to solve the EOS.</span>

<span class="sd">    .. math::</span>
<span class="sd">        P = \frac{RT}{V-b} - \frac{a\alpha(T)}{V(V+b)}</span>
<span class="sd">        </span>
<span class="sd">        a=\left(\frac{R^2(T_c)^{2}}{9(\sqrt[3]{2}-1)P_c} \right)</span>
<span class="sd">        =\frac{0.42748\cdot R^2(T_c)^{2}}{P_c}</span>
<span class="sd">    </span>
<span class="sd">        b=\left( \frac{(\sqrt[3]{2}-1)}{3}\right)\frac{RT_c}{P_c}</span>
<span class="sd">        =\frac{0.08664\cdot R T_c}{P_c}</span>
<span class="sd">        </span>
<span class="sd">        \alpha = \alpha^{(0)} + \omega(\alpha^{(1)}-\alpha^{(0)})</span>
<span class="sd">       </span>
<span class="sd">        \alpha^{(i)} = T_r^{N(M-1)}\exp[L(1-T_r^{NM})]</span>
<span class="sd">      </span>
<span class="sd">    For sub-critical conditions:</span>
<span class="sd">    </span>
<span class="sd">    L0, M0, N0 =  0.141599, 0.919422, 2.496441</span>
<span class="sd">    </span>
<span class="sd">    L1, M1, N1 = 0.500315, 0.799457, 3.291790</span>
<span class="sd">    </span>
<span class="sd">    For supercritical conditions:</span>
<span class="sd">    </span>
<span class="sd">    L0, M0, N0 = 0.441411, 6.500018, -0.20</span>
<span class="sd">    </span>
<span class="sd">    L1, M1, N1 = 0.032580,  1.289098, -8.0</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Tc : float</span>
<span class="sd">        Critical temperature, [K]</span>
<span class="sd">    Pc : float</span>
<span class="sd">        Critical pressure, [Pa]</span>
<span class="sd">    omega : float</span>
<span class="sd">        Acentric factor, [-]</span>
<span class="sd">    T : float, optional</span>
<span class="sd">        Temperature, [K]</span>
<span class="sd">    P : float, optional</span>
<span class="sd">        Pressure, [Pa]</span>
<span class="sd">    V : float, optional</span>
<span class="sd">        Molar volume, [m^3/mol]</span>

<span class="sd">    Examples</span>
<span class="sd">    --------    </span>
<span class="sd">    &gt;&gt;&gt; eos = TWUSRK(Tc=507.6, Pc=3025000, omega=0.2975, T=299., P=1E6)</span>
<span class="sd">    &gt;&gt;&gt; eos.phase, eos.V_l, eos.H_dep_l, eos.S_dep_l</span>
<span class="sd">    (&#39;l&#39;, 0.00014689217317770398, -31612.591872087483, -74.02294100343829)</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    There is no analytical solution for `T`. There are multiple possible </span>
<span class="sd">    solutions for `T` under certain conditions; no guaranteed are provided</span>
<span class="sd">    regarding which solution is obtained.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] Twu, Chorng H., John E. Coon, and John R. Cunningham. &quot;A New </span>
<span class="sd">       Generalized Alpha Function for a Cubic Equation of State Part 2. </span>
<span class="sd">       Redlich-Kwong Equation.&quot; Fluid Phase Equilibria 105, no. 1 (March 15, </span>
<span class="sd">       1995): 61-69. doi:10.1016/0378-3812(94)02602-W.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span> <span class="o">=</span> <span class="n">Tc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pc</span> <span class="o">=</span> <span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">omega</span> <span class="o">=</span> <span class="n">omega</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="n">V</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="n">Tc</span><span class="o">/</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_sufficient_inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Vc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zc</span><span class="o">*</span><span class="n">R</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">Pc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve_T</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">SRK</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">solve_T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
        
<div class="viewcode-block" id="TWUSRK.a_alpha_and_derivatives"><a class="viewcode-back" href="../../../functors/eos.html#thermosteam.functors.eos.TWUSRK.a_alpha_and_derivatives">[docs]</a>    <span class="k">def</span> <span class="nf">a_alpha_and_derivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Method to calculate `a_alpha` and its first and second</span>
<span class="sd">        derivatives for this EOS. Returns `a_alpha`, `da_alpha_dT`, and </span>
<span class="sd">        `d2a_alpha_dT2`. See `GCEOS.a_alpha_and_derivatives` for more </span>
<span class="sd">        documentation. Uses the set values of `Tc`, `omega`, and `a`.</span>
<span class="sd">        </span>
<span class="sd">        Because of its similarity for the TWUPR EOS, this has been moved to an </span>
<span class="sd">        external `TWU_a_alpha_common` function. See it for further </span>
<span class="sd">        documentation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">TWU_a_alpha_common</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="n">full</span><span class="p">,</span> <span class="n">quick</span><span class="o">=</span><span class="n">quick</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;SRK&#39;</span><span class="p">)</span></div></div>


<span class="n">eos_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">PR</span><span class="p">,</span> <span class="n">PR78</span><span class="p">,</span> <span class="n">PRSV</span><span class="p">,</span> <span class="n">PRSV2</span><span class="p">,</span> <span class="n">VDW</span><span class="p">,</span> <span class="n">RK</span><span class="p">,</span> <span class="n">SRK</span><span class="p">,</span> <span class="n">APISRK</span><span class="p">,</span> <span class="n">TWUPR</span><span class="p">,</span> <span class="n">TWUSRK</span><span class="p">]</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Yoel Cortes-Pena

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>